<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PowerShell AD Commands - Ultimate Collection</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #1a1a1a;
            --bg-secondary: #242424;
            --bg-card: #2d2d2d;
            --bg-hover: #3a3a3a;
            --text-primary: #ffffff;
            --text-secondary: #b8b8b8;
            --accent: #ffd700;
            --accent-hover: #ffed4e;
            --success: #52c41a;
            --danger: #ff4d4f;
            --info: #1890ff;
            --border: #404040;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, #0f0f0f 100%);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: var(--bg-secondary);
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            text-align: center;
            border: 2px solid var(--accent);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .header h1 {
            color: var(--accent);
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }

        .header p {
            color: var(--text-secondary);
            font-size: 1.1em;
        }

        .stats-bar {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .stat-item {
            background: var(--bg-card);
            padding: 15px 30px;
            border-radius: 8px;
            border: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .stat-number {
            color: var(--accent);
            font-size: 1.8em;
            font-weight: bold;
        }

        .stat-label {
            color: var(--text-secondary);
        }

        .navigation {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            background: var(--bg-secondary);
            padding: 15px;
            border-radius: 10px;
            position: sticky;
            top: 10px;
            z-index: 100;
            box-shadow: 0 5px 20px rgba(0,0,0,0.5);
        }

        .nav-btn {
            flex: 1;
            min-width: 140px;
            padding: 12px 20px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            text-align: center;
        }

        .nav-btn:hover {
            background: var(--bg-hover);
            border-color: var(--accent);
            transform: translateY(-2px);
        }

        .nav-btn.active {
            background: var(--accent);
            color: var(--bg-primary);
            border-color: var(--accent);
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .search-box {
            width: 100%;
            padding: 15px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 16px;
            margin-bottom: 25px;
        }

        .search-box:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.1);
        }

        .command-category {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
            border: 1px solid var(--border);
        }

        .category-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--accent);
        }

        .category-icon {
            font-size: 1.5em;
        }

        .category-title {
            font-size: 1.4em;
            color: var(--accent);
            font-weight: bold;
        }

        .commands-grid {
            display: grid;
            gap: 15px;
        }

        .command-card {
            background: var(--bg-card);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .command-card:hover {
            background: var(--bg-hover);
            border-color: var(--accent);
            transform: translateX(5px);
        }

        .command-card::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 3px;
            background: var(--accent);
            transform: scaleY(0);
            transition: transform 0.3s;
        }

        .command-card:hover::before {
            transform: scaleY(1);
        }

        .command-name {
            color: var(--accent);
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 8px;
        }

        .command-description {
            color: var(--text-secondary);
            margin-bottom: 15px;
            font-size: 0.95em;
        }

        .command-code {
            background: #0a0a0a;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 13px;
            color: #00ff00;
            overflow-x: auto;
            border-left: 3px solid var(--accent);
            position: relative;
        }

        .command-code:hover {
            background: #0f0f0f;
        }

        .copy-indicator {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--success);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        .copy-indicator.show {
            opacity: 1;
        }

        .command-tags {
            display: flex;
            gap: 8px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .tag {
            padding: 4px 8px;
            background: var(--bg-hover);
            border-radius: 4px;
            font-size: 11px;
            color: var(--text-secondary);
            border: 1px solid var(--border);
        }

        .tag.important {
            background: rgba(255, 215, 0, 0.1);
            border-color: var(--accent);
            color: var(--accent);
        }

        .tag.new {
            background: rgba(82, 196, 26, 0.1);
            border-color: var(--success);
            color: var(--success);
        }

        .tag.advanced {
            background: rgba(24, 144, 255, 0.1);
            border-color: var(--info);
            color: var(--info);
        }

        .quick-filters {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .filter-btn:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        .filter-btn.active {
            background: var(--accent);
            color: var(--bg-primary);
            border-color: var(--accent);
        }

        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-primary);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--accent);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent-hover);
        }

        .floating-menu {
            position: fixed;
            right: 20px;
            bottom: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .floating-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--accent);
            color: var(--bg-primary);
            border: none;
            cursor: pointer;
            font-size: 20px;
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.3);
            transition: all 0.3s;
        }

        .floating-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 30px rgba(255, 215, 0, 0.5);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>⚡ PowerShell AD Commands</h1>
            <p>Полная коллекция команд для работы с Active Directory</p>
        </div>

        <div class="stats-bar">
            <div class="stat-item">
                <span class="stat-number">250+</span>
                <span class="stat-label">Команд</span>
            </div>
            <div class="stat-item">
                <span class="stat-number">12</span>
                <span class="stat-label">Категорий</span>
            </div>
            <div class="stat-item">
                <span class="stat-number">50+</span>
                <span class="stat-label">Атрибутов</span>
            </div>
        </div>

        <div class="navigation">
            <button class="nav-btn active" onclick="showSection('users')">👤 Users</button>
            <button class="nav-btn" onclick="showSection('groups')">👥 Groups</button>
            <button class="nav-btn" onclick="showSection('computers')">💻 Computers</button>
            <button class="nav-btn" onclick="showSection('passwords')">🔐 Passwords</button>
            <button class="nav-btn" onclick="showSection('search')">🔍 Search</button>
            <button class="nav-btn" onclick="showSection('export')">📊 Export</button>
            <button class="nav-btn" onclick="showSection('audit')">📝 Audit</button>
            <button class="nav-btn" onclick="showSection('maintenance')">🛠️ Maintenance</button>
            <button class="nav-btn" onclick="showSection('reports')">📈 Reports</button>
            <button class="nav-btn" onclick="showSection('security')">🛡️ Security</button>
            <button class="nav-btn" onclick="showSection('automation')">🤖 Automation</button>
            <button class="nav-btn" onclick="showSection('troubleshoot')">🔧 Troubleshoot</button>
        </div>

        <!-- Users Section -->
        <div id="users-section" class="content-section active">
            <input type="text" class="search-box" placeholder="🔍 Поиск команд..." onkeyup="filterCommands('users')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">📋</span>
                    <span class="category-title">Получение информации о пользователях</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Все пользователи с полной информацией</div>
                        <div class="command-description">Получить всех пользователей со всеми атрибутами</div>
                        <div class="command-code">Get-ADUser -Filter * -Properties *</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Детальная информация о пользователе (интерактивно)</div>
                        <div class="command-description">Запрос имени пользователя и вывод полной информации включая дату истечения пароля</div>
                        <div class="command-code">$u = Read-Host 'User name'
$user = Get-ADUser -Identity $u -Properties LockedOut,DisplayName,PasswordLastSet,LastLogonDate,Description,info,EmailAddress,PasswordExpired,PasswordNeverExpires,LastBadPasswordAttempt,City,whenCreated,Enabled,EmailAddress,msDS-UserPasswordExpiryTimeComputed

if ($user.PasswordNeverExpires -eq $true) {
    $expiryDate = "Пароль никогда не истекает"
} else {
    $expiryDate = [datetime]::FromFileTime($user."msDS-UserPasswordExpiryTimeComputed")
}

$user | Select-Object DisplayName, LockedOut, PasswordLastSet, LastLogonDate, Description, info, EmailAddress, PasswordExpired, PasswordNeverExpires, LastBadPasswordAttempt, City, whenCreated, Enabled, @{Name="PasswordExpiryDate";Expression={$expiryDate}}</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag important">Интерактивный</span>
                            <span class="tag new">Расширенный</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Пользователи без email</div>
                        <div class="command-description">Найти всех пользователей с пустым полем email</div>
                        <div class="command-code">Get-ADUser -Filter * -Properties EmailAddress | Where-Object -Property EmailAddress -eq $null</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Поиск пользователей по имени (только активные)</div>
                        <div class="command-description">Найти активных пользователей по части имени</div>
                        <div class="command-code">Get-ADUser -Filter "(Name -like '*Dmitry*') -and (Enabled -eq 'True')" -Properties * | Select-Object Name, Enabled, SamAccountName, EmailAddress, Department</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Пользователи определенного отдела</div>
                        <div class="command-description">Найти всех пользователей из конкретного отдела</div>
                        <div class="command-code">Get-ADUser -Filter {Department -eq "IT"} -Properties Department, Title, Office | Select-Object Name, Department, Title, Office</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Пользователи с определенным менеджером</div>
                        <div class="command-description">Найти всех подчиненных конкретного менеджера</div>
                        <div class="command-code">$manager = Get-ADUser -Identity "ManagerUsername"
Get-ADUser -Filter {Manager -eq $manager.DistinguishedName} -Properties Manager, Title | Select-Object Name, Title</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Пользователи из конкретной OU</div>
                        <div class="command-description">Получить всех пользователей из определенной Organizational Unit</div>
                        <div class="command-code">Get-ADUser -Filter * -SearchBase "OU=Sales,OU=Users,DC=domain,DC=com" -Properties * | Select-Object Name, Title, Department</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Последний вход пользователя на все DC</div>
                        <div class="command-description">Проверить последний вход пользователя по всем контроллерам домена</div>
                        <div class="command-code">$Username = "username"
$DCs = Get-ADDomainController -Filter * | Select-Object -ExpandProperty Name
$LastLogon = @{}

foreach ($DC in $DCs) {
    try {
        $User = Get-ADUser $Username -Server $DC -Properties lastLogon, lastLogonTimestamp
        $LastLogon[$DC] = [datetime]::FromFileTime([Math]::Max($User.lastLogon, $User.lastLogonTimestamp))
    }
    catch {
        $LastLogon[$DC] = "N/A"
    }
}

$LastLogon.GetEnumerator() | Sort-Object Value -Descending | Format-Table -AutoSize</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag advanced">Продвинутый</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Пользователи с истекающим сроком действия аккаунта</div>
                        <div class="command-description">Найти пользователей, чьи аккаунты истекают в ближайшие 30 дней</div>
                        <div class="command-code">$ExpiryDate = (Get-Date).AddDays(30)
Get-ADUser -Filter {AccountExpirationDate -lt $ExpiryDate -and AccountExpirationDate -ne $null} -Properties AccountExpirationDate | 
    Select-Object Name, SamAccountName, AccountExpirationDate | 
    Sort-Object AccountExpirationDate</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Пользователи с пустыми полями</div>
                        <div class="command-description">Найти пользователей с незаполненными важными полями</div>
                        <div class="command-code">Get-ADUser -Filter * -Properties EmailAddress, Department, Title, Manager, Office | 
    Where-Object {
        -not $_.EmailAddress -or 
        -not $_.Department -or 
        -not $_.Title -or 
        -not $_.Manager -or 
        -not $_.Office
    } | Select-Object Name, EmailAddress, Department, Title, Office</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>
                </div>
            </div>

            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">🔒</span>
                    <span class="category-title">Статус и блокировки</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Заблокированные пользователи</div>
                        <div class="command-description">Найти всех заблокированных пользователей</div>
                        <div class="command-code">Search-ADAccount -LockedOut | Select-Object Name, SamAccountName, LockedOut, LastLogonDate</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Отключенные пользователи</div>
                        <div class="command-description">Список всех отключенных учетных записей</div>
                        <div class="command-code">Get-ADUser -Filter {Enabled -eq $false} -Properties LastLogonDate, whenChanged | 
    Select-Object Name, SamAccountName, Enabled, LastLogonDate, whenChanged | 
    Sort-Object whenChanged -Descending</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Пользователи с истекшими аккаунтами</div>
                        <div class="command-description">Найти пользователей с истекшим сроком действия учетной записи</div>
                        <div class="command-code">Search-ADAccount -AccountExpired | Select-Object Name, AccountExpirationDate, Enabled</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">История неудачных попыток входа</div>
                        <div class="command-description">Получить информацию о неудачных попытках входа</div>
                        <div class="command-code">Get-ADUser -Filter * -Properties BadLogonCount, LastBadPasswordAttempt, BadPwdCount, LockedOut | 
    Where-Object {$_.BadLogonCount -gt 0} | 
    Select-Object Name, BadLogonCount, LastBadPasswordAttempt, LockedOut | 
    Sort-Object BadLogonCount -Descending</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Разблокировать всех пользователей</div>
                        <div class="command-description">Массовая разблокировка всех заблокированных пользователей</div>
                        <div class="command-code">Search-ADAccount -LockedOut | Unlock-ADAccount</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag important">Осторожно</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">✏️</span>
                    <span class="category-title">Создание и модификация</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Создать пользователя (полный набор атрибутов)</div>
                        <div class="command-description">Создание нового пользователя со всеми основными атрибутами</div>
                        <div class="command-code">New-ADUser -Name "Ivan Petrov" `
    -GivenName "Ivan" `
    -Surname "Petrov" `
    -SamAccountName "ipetrov" `
    -UserPrincipalName "ipetrov@domain.com" `
    -EmailAddress "ipetrov@domain.com" `
    -Path "OU=Users,DC=domain,DC=com" `
    -AccountPassword (ConvertTo-SecureString "P@ssw0rd123!" -AsPlainText -Force) `
    -ChangePasswordAtLogon $true `
    -Department "IT" `
    -Title "System Administrator" `
    -Office "Moscow" `
    -OfficePhone "+7-495-123-4567" `
    -Company "Company Name" `
    -Manager "jsmith" `
    -Enabled $true</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Копировать пользователя</div>
                        <div class="command-description">Создать нового пользователя на основе существующего</div>
                        <div class="command-code">$TemplateUser = Get-ADUser -Identity "TemplateUser" -Properties *
$NewUser = @{
    Name = "New User"
    GivenName = "New"
    Surname = "User"
    SamAccountName = "nuser"
    UserPrincipalName = "nuser@domain.com"
    AccountPassword = (ConvertTo-SecureString "TempP@ss123" -AsPlainText -Force)
    Path = $TemplateUser.DistinguishedName.Split(',',2)[1]
    Department = $TemplateUser.Department
    Title = $TemplateUser.Title
    Company = $TemplateUser.Company
    Manager = $TemplateUser.Manager
    Office = $TemplateUser.Office
    Enabled = $true
    ChangePasswordAtLogon = $true
}
New-ADUser @NewUser

# Копировать членство в группах
Get-ADPrincipalGroupMembership $TemplateUser | Where-Object {$_.Name -ne "Domain Users"} | Add-ADPrincipalGroupMembership -Members "nuser"</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag advanced">Продвинутый</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Массовое обновление атрибутов</div>
                        <div class="command-description">Обновить атрибуты для всех пользователей в OU</div>
                        <div class="command-code">Get-ADUser -Filter * -SearchBase "OU=Sales,DC=domain,DC=com" | 
    Set-ADUser -Company "New Company Name" -Office "New Office"</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Добавить фото пользователя</div>
                        <div class="command-description">Загрузить фотографию пользователя в AD</div>
                        <div class="command-code">$photo = [byte[]](Get-Content "C:\Photos\user.jpg" -Encoding byte)
Set-ADUser "username" -Replace @{thumbnailPhoto=$photo}</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Groups Section -->
        <div id="groups-section" class="content-section">
            <input type="text" class="search-box" placeholder="🔍 Поиск команд..." onkeyup="filterCommands('groups')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">👥</span>
                    <span class="category-title">Управление группами</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Все группы пользователя (развернуто)</div>
                        <div class="command-description">Получить все группы для конкретного пользователя</div>
                        <div class="command-code">Get-ADUser "username" -Properties MemberOf | Select-Object -ExpandProperty MemberOf | Get-ADGroup | Select-Object Name, GroupCategory, GroupScope</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Пустые группы</div>
                        <div class="command-description">Найти все группы без участников</div>
                        <div class="command-code">Get-ADGroup -Filter * -Properties Members | Where-Object {$_.Members.Count -eq 0} | Select-Object Name, GroupCategory, DistinguishedName</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Группы с одним участником</div>
                        <div class="command-description">Найти группы только с одним членом</div>
                        <div class="command-code">Get-ADGroup -Filter * -Properties Members | Where-Object {$_.Members.Count -eq 1} | Select-Object Name, @{N='SingleMember';E={(Get-ADObject $_.Members[0]).Name}}</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Рекурсивное членство в группе</div>
                        <div class="command-description">Получить всех членов группы включая вложенные группы</div>
                        <div class="command-code">Get-ADGroupMember -Identity "GroupName" -Recursive | Select-Object Name, ObjectClass, SamAccountName | Sort-Object ObjectClass, Name</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Сравнение членства двух групп</div>
                        <div class="command-description">Найти различия в членстве между двумя группами</div>
                        <div class="command-code">$Group1 = "Group1Name"
$Group2 = "Group2Name"

$Members1 = Get-ADGroupMember -Identity $Group1 | Select-Object -ExpandProperty SamAccountName
$Members2 = Get-ADGroupMember -Identity $Group2 | Select-Object -ExpandProperty SamAccountName

$Comparison = Compare-Object -ReferenceObject $Members1 -DifferenceObject $Members2 -IncludeEqual

$Comparison | ForEach-Object {
    [PSCustomObject]@{
        User = $_.InputObject
        Status = switch ($_.SideIndicator) {
            '<=' {"Only in $Group1"}
            '=>' {"Only in $Group2"}
            '==' {"In both groups"}
        }
    }
} | Format-Table -AutoSize</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag advanced">Продвинутый</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Найти циклические вложения групп</div>
                        <div class="command-description">Обнаружить циклические зависимости в группах</div>
                        <div class="command-code">function Find-CircularNesting {
    $Groups = Get-ADGroup -Filter *
    $CircularGroups = @()
    
    foreach ($Group in $Groups) {
        $AllMembers = @()
        try {
            $AllMembers = Get-ADGroupMember -Identity $Group -Recursive -ErrorAction Stop
            if ($Group.DistinguishedName -in $AllMembers.DistinguishedName) {
                $CircularGroups += $Group
            }
        } catch {
            if ($_.Exception.Message -like "*circular*") {
                $CircularGroups += $Group
            }
        }
    }
    return $CircularGroups
}

Find-CircularNesting | Select-Object Name, DistinguishedName</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag advanced">Продвинутый</span>
                            <span class="tag important">Диагностика</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Административные группы и их члены</div>
                        <div class="command-description">Получить все административные группы с участниками</div>
                        <div class="command-code">$AdminGroups = @("Domain Admins", "Enterprise Admins", "Schema Admins", "Administrators", "Account Operators", "Server Operators", "Backup Operators")

foreach ($Group in $AdminGroups) {
    Write-Host "`n=== $Group ===" -ForegroundColor Yellow
    try {
        Get-ADGroupMember -Identity $Group -Recursive | 
            Where-Object {$_.objectClass -eq 'user'} | 
            Get-ADUser -Properties Enabled, LastLogonDate | 
            Select-Object Name, SamAccountName, Enabled, LastLogonDate | 
            Format-Table -AutoSize
    } catch {
        Write-Host "Group not found or access denied" -ForegroundColor Red
    }
}</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag important">Security</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Computers Section -->
        <div id="computers-section" class="content-section">
            <input type="text" class="search-box" placeholder="🔍 Поиск команд..." onkeyup="filterCommands('computers')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">💻</span>
                    <span class="category-title">Информация о компьютерах</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Количество Windows Servers</div>
                        <div class="command-description">Подсчет всех Windows серверов в домене</div>
                        <div class="command-code">(Get-ADComputer -Filter {Enabled -eq "true" -and OperatingSystem -like "*Windows Server*"}).Count</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Детальный список Windows Servers</div>
                        <div class="command-description">Полная информация о всех серверах</div>
                        <div class="command-code">Get-ADComputer -Filter 'OperatingSystem -like "*Windows Server*" -and Enabled -eq "true"' -Properties Name, OperatingSystem, OperatingSystemVersion, OperatingSystemServicePack, IPv4Address, LastLogonDate | 
    Sort-Object -Property OperatingSystem | 
    Select-Object -Property Name, OperatingSystem, OperatingSystemVersion, OperatingSystemServicePack, IPv4Address, LastLogonDate | 
    Format-Table -Wrap -AutoSize</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Компьютеры по версиям ОС</div>
                        <div class="command-description">Группировка компьютеров по операционным системам</div>
                        <div class="command-code">Get-ADComputer -Filter * -Properties OperatingSystem, OperatingSystemVersion | 
    Group-Object -Property OperatingSystem | 
    Select-Object @{Name="Operating System";Expression={$_.Name}}, 
                  @{Name="Count";Expression={$_.Count}}, 
                  @{Name="Versions";Expression={($_.Group | Select-Object -Unique OperatingSystemVersion).OperatingSystemVersion -join ', '}} | 
    Sort-Object Count -Descending | 
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Компьютеры без последнего входа</div>
                        <div class="command-description">Найти компьютеры, которые никогда не подключались к домену</div>
                        <div class="command-code">Get-ADComputer -Filter {LastLogonDate -notlike "*"} -Properties LastLogonDate, whenCreated | 
    Select-Object Name, DNSHostName, whenCreated | 
    Sort-Object whenCreated</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Контроллеры домена</div>
                        <div class="command-description">Список всех контроллеров домена с детальной информацией</div>
                        <div class="command-code">Get-ADDomainController -Filter * | 
    Select-Object Name, IPv4Address, OperatingSystem, Site, IsGlobalCatalog, IsReadOnly, @{Name="FSMO Roles";Expression={$_.OperationMasterRoles -join ', '}} | 
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Компьютеры с BitLocker</div>
                        <div class="command-description">Найти компьютеры с включенным BitLocker</div>
                        <div class="command-code">Get-ADObject -Filter {objectClass -eq "msFVE-RecoveryInformation"} -SearchBase (Get-ADRootDSE).defaultNamingContext -Properties msFVE-RecoveryPassword, whenCreated | 
    ForEach-Object {
        $ComputerName = ($_.DistinguishedName -split ',')[1] -replace 'CN=',''
        [PSCustomObject]@{
            Computer = $ComputerName
            RecoveryPasswordID = $_.Name
            WhenCreated = $_.whenCreated
        }
    } | Sort-Object Computer</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag advanced">Security</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Проверка доступности компьютеров</div>
                        <div class="command-description">Массовая проверка онлайн статуса компьютеров</div>
                        <div class="command-code">Get-ADComputer -Filter {Enabled -eq $true} -Properties LastLogonDate | 
    Select-Object -First 20 | 
    ForEach-Object {
        $Computer = $_.Name
        $Online = Test-Connection -ComputerName $Computer -Count 1 -Quiet
        [PSCustomObject]@{
            Computer = $Computer
            Status = if($Online){"🟢 Online"}else{"🔴 Offline"}
            LastLogon = $_.LastLogonDate
        }
    } | Format-Table -AutoSize</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Passwords Section -->
        <div id="passwords-section" class="content-section">
            <input type="text" class="search-box" placeholder="🔍 Поиск команд..." onkeyup="filterCommands('passwords')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">🔐</span>
                    <span class="category-title">Управление паролями</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Пользователи с бессрочными паролями</div>
                        <div class="command-description">Экспорт всех активных пользователей с паролями, которые никогда не истекают</div>
                        <div class="command-code">$users = Get-ADUser -Filter {(PasswordNeverExpires -eq $true) -and (Enabled -eq $true)} -Properties *
$users | Select-Object Name, SamAccountName, DistinguishedName, EmailAddress, Department, Title, PasswordLastSet, LastLogonDate | 
    Export-Csv -Path "C:\Export\NonExpiringPasswords_$(Get-Date -Format 'yyyyMMdd').csv" -NoTypeInformation</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag important">Security</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Сервисные аккаунты по маске</div>
                        <div class="command-description">Найти все сервисные аккаунты и проверить настройки паролей</div>
                        <div class="command-code"># Изменить маску под свои нужды (svc*, srv*, service*)
$mask = "*svc*"
$users = Get-ADUser -Filter "SamAccountName -like '$mask' -and Enabled -eq `$true" -Properties SamAccountName, PasswordNeverExpires, PasswordLastSet, ServicePrincipalName, Description

Write-Host "`n=== Сервисные аккаунты с маской $mask ===" -ForegroundColor Yellow
foreach ($user in $users) {
    Write-Host "`nПользователь: $($user.SamAccountName)" -ForegroundColor Cyan
    Write-Host "  Описание: $($user.Description)"
    Write-Host "  PasswordNeverExpires: $($user.PasswordNeverExpires)"
    Write-Host "  PasswordLastSet: $($user.PasswordLastSet)"
    Write-Host "  ServicePrincipalName: $($user.ServicePrincipalName -join ', ')"
}

Write-Host "`nВсего найдено: $($users.Count) аккаунтов" -ForegroundColor Green</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Точная дата истечения пароля пользователя</div>
                        <div class="command-description">Вычислить дату истечения пароля для конкретного пользователя</div>
                        <div class="command-code">Get-ADUser -Identity "USERNAME" -Properties msDS-UserPasswordExpiryTimeComputed, PasswordNeverExpires, PasswordLastSet | 
    Select-Object Name, 
                  PasswordLastSet,
                  PasswordNeverExpires,
                  @{Name="PasswordExpiryDate";Expression={
                      if($_.PasswordNeverExpires) {
                          "Never"
                      } else {
                          [datetime]::FromFileTime($_."msDS-UserPasswordExpiryTimeComputed")
                      }
                  }},
                  @{Name="DaysUntilExpiry";Expression={
                      if(-not $_.PasswordNeverExpires) {
                          (New-TimeSpan -Start (Get-Date) -End ([datetime]::FromFileTime($_."msDS-UserPasswordExpiryTimeComputed"))).Days
                      }
                  }}</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Пароли, истекающие в ближайшие 14 дней</div>
                        <div class="command-description">Найти всех пользователей с истекающими паролями</div>
                        <div class="command-code">$DaysToExpire = 14
$MaxPasswordAge = (Get-ADDefaultDomainPasswordPolicy).MaxPasswordAge.Days

Get-ADUser -Filter {Enabled -eq $true -and PasswordNeverExpires -eq $false} -Properties PasswordLastSet, EmailAddress, Manager | 
    Select-Object Name, 
                  SamAccountName, 
                  EmailAddress,
                  @{N='Manager';E={(Get-ADUser $_.Manager -ErrorAction SilentlyContinue).Name}},
                  PasswordLastSet,
                  @{N="ExpiryDate";E={$_.PasswordLastSet.AddDays($MaxPasswordAge)}},
                  @{N="DaysLeft";E={($_.PasswordLastSet.AddDays($MaxPasswordAge) - (Get-Date)).Days}} |
    Where-Object {$_.DaysLeft -le $DaysToExpire -and $_.DaysLeft -ge 0} |
    Sort-Object DaysLeft |
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Парольная политика домена</div>
                        <div class="command-description">Получить текущие настройки парольной политики</div>
                        <div class="command-code">Get-ADDefaultDomainPasswordPolicy | 
    Select-Object @{N='Минимальная длина';E={$_.MinPasswordLength}},
                  @{N='Максимальный возраст (дней)';E={$_.MaxPasswordAge.Days}},
                  @{N='Минимальный возраст (дней)';E={$_.MinPasswordAge.Days}},
                  @{N='История паролей';E={$_.PasswordHistoryCount}},
                  @{N='Сложность включена';E={$_.ComplexityEnabled}},
                  @{N='Порог блокировки';E={$_.LockoutThreshold}},
                  @{N='Длительность блокировки';E={$_.LockoutDuration}},
                  @{N='Окно наблюдения';E={$_.LockoutObservationWindow}} |
    Format-List</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Массовый сброс паролей из CSV</div>
                        <div class="command-description">Сбросить пароли для списка пользователей из файла</div>
                        <div class="command-code"># CSV должен содержать колонку SamAccountName
$Users = Import-Csv "C:\PasswordReset\users.csv"
$DefaultPassword = "TempP@ssw0rd2024!"
$Results = @()

foreach ($User in $Users) {
    try {
        Set-ADAccountPassword -Identity $User.SamAccountName `
            -Reset `
            -NewPassword (ConvertTo-SecureString $DefaultPassword -AsPlainText -Force)
        Set-ADUser -Identity $User.SamAccountName -ChangePasswordAtLogon $true
        
        $Results += [PSCustomObject]@{
            User = $User.SamAccountName
            Status = "Success"
            Message = "Password reset successfully"
        }
        Write-Host "✅ Password reset for: $($User.SamAccountName)" -ForegroundColor Green
    }
    catch {
        $Results += [PSCustomObject]@{
            User = $User.SamAccountName
            Status = "Failed"
            Message = $_.Exception.Message
        }
        Write-Host "❌ Failed to reset password for: $($User.SamAccountName)" -ForegroundColor Red
    }
}

$Results | Export-Csv "C:\PasswordReset\results_$(Get-Date -Format 'yyyyMMdd_HHmmss').csv" -NoTypeInformation</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag important">Bulk Operation</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Fine-Grained Password Policies</div>
                        <div class="command-description">Получить все тонкие парольные политики</div>
                        <div class="command-code">Get-ADFineGrainedPasswordPolicy -Filter * | 
    Select-Object Name, 
                  Precedence,
                  MinPasswordLength,
                  @{N='MaxPasswordAge';E={$_.MaxPasswordAge.Days}},
                  @{N='AppliesTo';E={($_.AppliesTo | ForEach-Object {(Get-ADObject $_).Name}) -join ', '}},
                  ComplexityEnabled,
                  LockoutThreshold | 
    Sort-Object Precedence | 
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag advanced">Advanced</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Search Section -->
        <div id="search-section" class="content-section">
            <input type="text" class="search-box" placeholder="🔍 Поиск команд..." onkeyup="filterCommands('search')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">🔍</span>
                    <span class="category-title">Поиск и фильтрация</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Универсальный поиск объектов</div>
                        <div class="command-description">Поиск любых объектов AD по имени</div>
                        <div class="command-code">$SearchTerm = "*admin*"
Get-ADObject -Filter "Name -like '$SearchTerm'" | 
    Select-Object Name, ObjectClass, DistinguishedName | 
    Sort-Object ObjectClass, Name | 
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Поиск по описанию</div>
                        <div class="command-description">Найти все объекты с определенным текстом в описании</div>
                        <div class="command-code">Get-ADObject -Filter {Description -like "*service account*"} -Properties Description | 
    Select-Object Name, ObjectClass, Description | 
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Поиск дубликатов email</div>
                        <div class="command-description">Найти пользователей с одинаковыми email адресами</div>
                        <div class="command-code">Get-ADUser -Filter {EmailAddress -like "*"} -Properties EmailAddress | 
    Group-Object -Property EmailAddress | 
    Where-Object {$_.Count -gt 1} | 
    ForEach-Object {
        Write-Host "`nDuplicate Email: $($_.Name)" -ForegroundColor Red
        $_.Group | Select-Object Name, SamAccountName, DistinguishedName | Format-Table -AutoSize
    }</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag important">Data Quality</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Поиск по телефону</div>
                        <div class="command-description">Найти пользователя по номеру телефона</div>
                        <div class="command-code">$PhoneNumber = "*495*"
Get-ADUser -Filter "telephoneNumber -like '$PhoneNumber' -or mobile -like '$PhoneNumber' -or homePhone -like '$PhoneNumber'" -Properties telephoneNumber, mobile, homePhone | 
    Select-Object Name, 
                  @{N='Office';E={$_.telephoneNumber}}, 
                  @{N='Mobile';E={$_.mobile}}, 
                  @{N='Home';E={$_.homePhone}} | 
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Поиск по SID</div>
                        <div class="command-description">Найти объект по Security Identifier</div>
                        <div class="command-code">$SID = "S-1-5-21-..."
Get-ADObject -Filter {objectSid -eq $SID} -Properties * | 
    Select-Object Name, ObjectClass, DistinguishedName</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Wildcard поиск пользователей</div>
                        <div class="command-description">Поиск пользователей с использованием wildcards</div>
                        <div class="command-code"># Поиск по началу имени
Get-ADUser -Filter {Name -like "John*"}

# Поиск по окончанию
Get-ADUser -Filter {Name -like "*son"}

# Поиск по середине
Get-ADUser -Filter {Name -like "*mit*"}

# Комбинированный поиск
Get-ADUser -Filter {(Name -like "J*") -and (Surname -like "S*")}</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Export Section -->
        <div id="export-section" class="content-section">
            <input type="text" class="search-box" placeholder="🔍 Поиск команд..." onkeyup="filterCommands('export')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">📊</span>
                    <span class="category-title">Экспорт и импорт данных</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Полный экспорт пользователей с форматированием</div>
                        <div class="command-description">Экспорт всех пользователей с читаемым форматом менеджера</div>
                        <div class="command-code">Get-ADUser -Filter * -Properties * | 
    Select-Object Name, 
                  SamAccountName,
                  UserPrincipalName,
                  EmailAddress,
                  Title,
                  Department,
                  Office,
                  @{N='Manager';E={(Get-ADUser $_.Manager -ErrorAction SilentlyContinue).Name}},
                  @{N='Groups';E={(Get-ADPrincipalGroupMembership $_.SamAccountName | Select-Object -ExpandProperty Name) -join '; '}},
                  Enabled,
                  @{N='PasswordNeverExpires';E={$_.PasswordNeverExpires}},
                  LastLogonDate,
                  whenCreated | 
    Export-Csv -Path "C:\Export\AllUsers_$(Get-Date -Format 'yyyyMMdd_HHmmss').csv" -NoTypeInformation -Encoding UTF8</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Экспорт структуры OU</div>
                        <div class="command-description">Экспортировать полную структуру Organizational Units</div>
                        <div class="command-code">Get-ADOrganizationalUnit -Filter * -Properties * | 
    Select-Object @{N='Level';E={($_.DistinguishedName -split ',').Count - 2}},
                  Name,
                  @{N='Parent';E={($_.DistinguishedName -split ',',2)[1]}},
                  Description,
                  @{N='Protected';E={$_.ProtectedFromAccidentalDeletion}},
                  whenCreated,
                  @{N='Children';E={(Get-ADObject -Filter * -SearchBase $_.DistinguishedName -SearchScope OneLevel).Count}} |
    Sort-Object Level, Parent, Name |
    Export-Csv -Path "C:\Export\OU_Structure.csv" -NoTypeInformation</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Массовый импорт пользователей с проверкой</div>
                        <div class="command-description">Импорт пользователей из CSV с валидацией и логированием</div>
                        <div class="command-code"># CSV columns: Name,GivenName,Surname,SamAccountName,EmailAddress,Department,Title,Manager,Password
$Users = Import-Csv -Path "C:\Import\NewUsers.csv"
$LogFile = "C:\Import\import_log_$(Get-Date -Format 'yyyyMMdd_HHmmss').txt"
$ErrorLog = "C:\Import\import_errors_$(Get-Date -Format 'yyyyMMdd_HHmmss').txt"

foreach ($User in $Users) {
    try {
        # Check if user already exists
        if (Get-ADUser -Filter "SamAccountName -eq '$($User.SamAccountName)'" -ErrorAction SilentlyContinue) {
            $Message = "User $($User.SamAccountName) already exists - skipping"
            Write-Warning $Message
            Add-Content -Path $ErrorLog -Value "$(Get-Date -Format 'yyyy-MM-dd HH:mm:ss'): $Message"
            continue
        }
        
        # Create user parameters
        $NewUserParams = @{
            Name = $User.Name
            GivenName = $User.GivenName
            Surname = $User.Surname
            SamAccountName = $User.SamAccountName
            UserPrincipalName = "$($User.SamAccountName)@$((Get-ADDomain).DNSRoot)"
            EmailAddress = $User.EmailAddress
            Department = $User.Department
            Title = $User.Title
            AccountPassword = (ConvertTo-SecureString $User.Password -AsPlainText -Force)
            Enabled = $true
            ChangePasswordAtLogon = $true
            Path = "OU=Users,$(Get-ADDomain).DistinguishedName"
        }
        
        # Create user
        New-ADUser @NewUserParams
        
        # Set manager if specified
        if ($User.Manager) {
            Set-ADUser -Identity $User.SamAccountName -Manager $User.Manager
        }
        
        $Message = "Successfully created user: $($User.SamAccountName)"
        Write-Host $Message -ForegroundColor Green
        Add-Content -Path $LogFile -Value "$(Get-Date -Format 'yyyy-MM-dd HH:mm:ss'): $Message"
        
    } catch {
        $ErrorMessage = "Failed to create user $($User.SamAccountName): $_"
        Write-Error $ErrorMessage
        Add-Content -Path $ErrorLog -Value "$(Get-Date -Format 'yyyy-MM-dd HH:mm:ss'): $ErrorMessage"
    }
}

Write-Host "`nImport completed. Check logs at:" -ForegroundColor Cyan
Write-Host "  Success log: $LogFile" -ForegroundColor Green
Write-Host "  Error log: $ErrorLog" -ForegroundColor Yellow</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag important">Bulk Operation</span>
                            <span class="tag advanced">With Validation</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Backup полной структуры AD</div>
                        <div class="command-description">Создать полный backup всех объектов AD</div>
                        <div class="command-code">$BackupPath = "C:\ADBackup\$(Get-Date -Format 'yyyyMMdd')"
New-Item -ItemType Directory -Path $BackupPath -Force | Out-Null

Write-Host "Starting AD Backup to $BackupPath" -ForegroundColor Cyan

# Users
Write-Host "Backing up Users..." -ForegroundColor Yellow
Get-ADUser -Filter * -Properties * | Export-Clixml -Path "$BackupPath\Users.xml"

# Groups
Write-Host "Backing up Groups..." -ForegroundColor Yellow
Get-ADGroup -Filter * -Properties * | Export-Clixml -Path "$BackupPath\Groups.xml"

# Group Memberships
Write-Host "Backing up Group Memberships..." -ForegroundColor Yellow
Get-ADGroup -Filter * | ForEach-Object {
    $group = $_
    Get-ADGroupMember -Identity $group -Recursive | Select-Object @{N='Group';E={$group.Name}}, Name, SamAccountName, ObjectClass
} | Export-Clixml -Path "$BackupPath\GroupMemberships.xml"

# Computers
Write-Host "Backing up Computers..." -ForegroundColor Yellow
Get-ADComputer -Filter * -Properties * | Export-Clixml -Path "$BackupPath\Computers.xml"

# OUs
Write-Host "Backing up OUs..." -ForegroundColor Yellow
Get-ADOrganizationalUnit -Filter * -Properties * | Export-Clixml -Path "$BackupPath\OUs.xml"

# GPO Links
Write-Host "Backing up GPO Links..." -ForegroundColor Yellow
Get-ADOrganizationalUnit -Filter * | Get-GPInheritance | Export-Clixml -Path "$BackupPath\GPOLinks.xml"

Write-Host "`nBackup completed successfully!" -ForegroundColor Green
Write-Host "Location: $BackupPath" -ForegroundColor Cyan</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag important">Backup</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Audit Section -->
        <div id="audit-section" class="content-section">
            <input type="text" class="search-box" placeholder="🔍 Поиск команд..." onkeyup="filterCommands('audit')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">📝</span>
                    <span class="category-title">Аудит и соответствие</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Полный аудит привилегированных групп</div>
                        <div class="command-description">Детальный отчет по всем административным группам</div>
                        <div class="command-code">$PrivGroups = @(
    "Domain Admins", "Enterprise Admins", "Schema Admins", 
    "Administrators", "Account Operators", "Server Operators", 
    "Print Operators", "Backup Operators", "Replicator",
    "Remote Desktop Users", "Network Configuration Operators"
)

$Report = @()

foreach ($GroupName in $PrivGroups) {
    try {
        $Group = Get-ADGroup -Identity $GroupName -Properties *
        $Members = Get-ADGroupMember -Identity $GroupName -Recursive
        
        foreach ($Member in $Members) {
            if ($Member.objectClass -eq 'user') {
                $User = Get-ADUser -Identity $Member -Properties Enabled, LastLogonDate, PasswordLastSet, PasswordNeverExpires
                
                $Report += [PSCustomObject]@{
                    Group = $GroupName
                    UserName = $User.Name
                    SamAccountName = $User.SamAccountName
                    Enabled = $User.Enabled
                    LastLogon = $User.LastLogonDate
                    PasswordLastSet = $User.PasswordLastSet
                    PasswordNeverExpires = $User.PasswordNeverExpires
                    MemberType = 'Direct/Nested'
                }
            }
        }
    } catch {
        Write-Warning "Could not process group: $GroupName"
    }
}

$Report | Export-Csv -Path "C:\Audit\PrivilegedGroups_$(Get-Date -Format 'yyyyMMdd').csv" -NoTypeInformation
$Report | Format-Table -AutoSize</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag important">Security</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Аудит изменений за последние 7 дней</div>
                        <div class="command-description">Найти все объекты, измененные за последнюю неделю</div>
                        <div class="command-code">$Days = 7
$StartDate = (Get-Date).AddDays(-$Days)

Write-Host "`n=== Changes in last $Days days ===" -ForegroundColor Yellow

# Modified Users
Write-Host "`nModified Users:" -ForegroundColor Cyan
Get-ADUser -Filter {whenChanged -ge $StartDate} -Properties whenChanged, whenCreated | 
    Select-Object Name, 
                  @{N='Action';E={if($_.whenCreated -ge $StartDate){'Created'}else{'Modified'}}},
                  whenChanged | 
    Sort-Object whenChanged -Descending | 
    Format-Table -AutoSize

# Modified Groups
Write-Host "`nModified Groups:" -ForegroundColor Cyan
Get-ADGroup -Filter {whenChanged -ge $StartDate} -Properties whenChanged, whenCreated | 
    Select-Object Name, 
                  @{N='Action';E={if($_.whenCreated -ge $StartDate){'Created'}else{'Modified'}}},
                  whenChanged | 
    Sort-Object whenChanged -Descending | 
    Format-Table -AutoSize

# Modified Computers
Write-Host "`nModified Computers:" -ForegroundColor Cyan
Get-ADComputer -Filter {whenChanged -ge $StartDate} -Properties whenChanged, whenCreated | 
    Select-Object Name, 
                  @{N='Action';E={if($_.whenCreated -ge $StartDate){'Created'}else{'Modified'}}},
                  whenChanged | 
    Sort-Object whenChanged -Descending | 
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Аудит прав AdminSDHolder</div>
                        <div class="command-description">Найти объекты с AdminCount=1</div>
                        <div class="command-code">Get-ADUser -Filter {adminCount -eq 1} -Properties adminCount, MemberOf | 
    Select-Object Name, 
                  SamAccountName, 
                  Enabled,
                  @{N='ProtectedGroups';E={
                      ($_.MemberOf | ForEach-Object {(Get-ADGroup $_).Name}) -join ', '
                  }} | 
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag advanced">Security</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Maintenance Section -->
        <div id="maintenance-section" class="content-section">
            <input type="text" class="search-box" placeholder="🔍 Поиск команд..." onkeyup="filterCommands('maintenance')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">🛠️</span>
                    <span class="category-title">Обслуживание и очистка</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Неактивные пользователи и компьютеры</div>
                        <div class="command-description">Найти и отключить неактивные объекты</div>
                        <div class="command-code">$InactiveDays = 90
$InactiveDate = (Get-Date).AddDays(-$InactiveDays)

# Find inactive users
$InactiveUsers = Get-ADUser -Filter {LastLogonDate -lt $InactiveDate -and Enabled -eq $true} -Properties LastLogonDate

Write-Host "Found $($InactiveUsers.Count) inactive users (no logon in $InactiveDays days)" -ForegroundColor Yellow

# Find inactive computers  
$InactiveComputers = Get-ADComputer -Filter {LastLogonDate -lt $InactiveDate -and Enabled -eq $true} -Properties LastLogonDate

Write-Host "Found $($InactiveComputers.Count) inactive computers (no logon in $InactiveDays days)" -ForegroundColor Yellow

# Optional: Disable them
# $InactiveUsers | Disable-ADAccount
# $InactiveComputers | Disable-ADAccount</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Очистка пустых групп</div>
                        <div class="command-description">Найти и удалить пустые группы</div>
                        <div class="command-code">$EmptyGroups = Get-ADGroup -Filter * -Properties Members | 
    Where-Object {$_.Members.Count -eq 0 -and $_.GroupCategory -eq 'Security'}

Write-Host "Found $($EmptyGroups.Count) empty security groups" -ForegroundColor Yellow
$EmptyGroups | Select-Object Name, GroupScope, DistinguishedName | Format-Table -AutoSize

# To delete (uncomment):
# $EmptyGroups | Remove-ADGroup -Confirm:$false</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Проверка репликации AD</div>
                        <div class="command-description">Проверить статус репликации между контроллерами домена</div>
                        <div class="command-code"># Get replication status
Write-Host "Checking AD Replication Status..." -ForegroundColor Cyan

# Summary
repadmin /replsummary

# Detailed check
Get-ADReplicationPartnerMetadata -Target * -Partition * |
    Select-Object Server, 
                  Partner, 
                  Partition,
                  ConsecutiveReplicationFailures,
                  LastReplicationSuccess,
                  @{N='LastRepDuration';E={$_.LastReplicationResult}} |
    Format-Table -AutoSize

# Check for failures
$Failures = Get-ADReplicationFailure -Target * -Scope Forest
if ($Failures) {
    Write-Host "`nReplication Failures Detected:" -ForegroundColor Red
    $Failures | Format-Table -AutoSize
} else {
    Write-Host "`nNo replication failures detected" -ForegroundColor Green
}</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag important">Health Check</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Reports Section -->
        <div id="reports-section" class="content-section">
            <input type="text" class="search-box" placeholder="🔍 Поиск команд..." onkeyup="filterCommands('reports')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">📈</span>
                    <span class="category-title">Отчеты и статистика</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Комплексный отчет о домене</div>
                        <div class="command-description">Полная статистика по домену Active Directory</div>
                        <div class="command-code">$Domain = Get-ADDomain
$Forest = Get-ADForest

Write-Host "`n========== DOMAIN REPORT ==========" -ForegroundColor Cyan
Write-Host "Domain: $($Domain.DNSRoot)"
Write-Host "NetBIOS: $($Domain.NetBIOSName)"
Write-Host "Forest: $($Forest.Name)"
Write-Host "Domain Functional Level: $($Domain.DomainMode)"
Write-Host "Forest Functional Level: $($Forest.ForestMode)"

# Statistics
$Stats = @{
    'Total Users' = (Get-ADUser -Filter *).Count
    'Enabled Users' = (Get-ADUser -Filter {Enabled -eq $true}).Count
    'Disabled Users' = (Get-ADUser -Filter {Enabled -eq $false}).Count
    'Locked Users' = (Search-ADAccount -LockedOut).Count
    'Total Groups' = (Get-ADGroup -Filter *).Count
    'Security Groups' = (Get-ADGroup -Filter {GroupCategory -eq "Security"}).Count
    'Distribution Groups' = (Get-ADGroup -Filter {GroupCategory -eq "Distribution"}).Count
    'Total Computers' = (Get-ADComputer -Filter *).Count
    'Enabled Computers' = (Get-ADComputer -Filter {Enabled -eq $true}).Count
    'Windows Servers' = (Get-ADComputer -Filter {OperatingSystem -like "*Server*"}).Count
    'Windows 10' = (Get-ADComputer -Filter {OperatingSystem -like "*Windows 10*"}).Count
    'Windows 11' = (Get-ADComputer -Filter {OperatingSystem -like "*Windows 11*"}).Count
    'Domain Controllers' = (Get-ADDomainController -Filter *).Count
    'Organizational Units' = (Get-ADOrganizationalUnit -Filter *).Count
}

Write-Host "`n=== Statistics ===" -ForegroundColor Yellow
$Stats.GetEnumerator() | Sort-Object Name | ForEach-Object {
    Write-Host "$($_.Key): $($_.Value)"
}</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">HTML отчет о пользователях</div>
                        <div class="command-description">Создать красивый HTML отчет</div>
                        <div class="command-code">$Users = Get-ADUser -Filter * -Properties * | 
    Select-Object Name, SamAccountName, EmailAddress, Department, Title, 
                  Enabled, LastLogonDate, PasswordLastSet, PasswordNeverExpires

$HTML = @"
<!DOCTYPE html>
<html>
<head>
    <title>AD Users Report</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f0f0f0; }
        h1 { color: #333; text-align: center; }
        table { border-collapse: collapse; width: 100%; margin: 20px auto; background: white; }
        th { background-color: #4CAF50; color: white; padding: 12px; text-align: left; }
        td { padding: 10px; border-bottom: 1px solid #ddd; }
        tr:hover { background-color: #f5f5f5; }
        .disabled { color: red; }
        .enabled { color: green; }
    </style>
</head>
<body>
    <h1>Active Directory Users Report - $(Get-Date -Format 'yyyy-MM-dd')</h1>
    <table>
        <tr>
            <th>Name</th>
            <th>Username</th>
            <th>Email</th>
            <th>Department</th>
            <th>Title</th>
            <th>Status</th>
            <th>Last Logon</th>
            <th>Password Set</th>
        </tr>
"@

foreach ($User in $Users) {
    $StatusClass = if ($User.Enabled) { "enabled" } else { "disabled" }
    $Status = if ($User.Enabled) { "Active" } else { "Disabled" }
    
    $HTML += @"
        <tr>
            <td>$($User.Name)</td>
            <td>$($User.SamAccountName)</td>
            <td>$($User.EmailAddress)</td>
            <td>$($User.Department)</td>
            <td>$($User.Title)</td>
            <td class='$StatusClass'>$Status</td>
            <td>$($User.LastLogonDate)</td>
            <td>$($User.PasswordLastSet)</td>
        </tr>
"@
}

$HTML += @"
    </table>
    <p style='text-align: center; color: #666;'>Total users: $($Users.Count)</p>
</body>
</html>
"@

$HTML | Out-File "C:\Reports\ADUsers_$(Get-Date -Format 'yyyyMMdd').html"
Write-Host "Report saved to C:\Reports\ADUsers_$(Get-Date -Format 'yyyyMMdd').html" -ForegroundColor Green</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag new">HTML Report</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Security Section -->
        <div id="security-section" class="content-section">
            <input type="text" class="search-box" placeholder="🔍 Поиск команд..." onkeyup="filterCommands('security')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">🛡️</span>
                    <span class="category-title">Безопасность</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Обнаружение Kerberoastable аккаунтов</div>
                        <div class="command-description">Найти учетные записи, уязвимые для Kerberoasting</div>
                        <div class="command-code">Get-ADUser -Filter {ServicePrincipalName -ne "$null"} -Properties ServicePrincipalName, PasswordLastSet, LastLogonDate | 
    Select-Object Name, 
                  SamAccountName,
                  @{N='SPNs';E={$_.ServicePrincipalName -join '; '}},
                  PasswordLastSet,
                  LastLogonDate,
                  Enabled | 
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag important">Security</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Обнаружение ASREPRoastable аккаунтов</div>
                        <div class="command-description">Найти учетные записи без Kerberos предварительной аутентификации</div>
                        <div class="command-code">Get-ADUser -Filter * -Properties DoesNotRequirePreAuth | 
    Where-Object {$_.DoesNotRequirePreAuth -eq $true} | 
    Select-Object Name, SamAccountName, DoesNotRequirePreAuth, Enabled | 
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag important">Security</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Делегирование Kerberos</div>
                        <div class="command-description">Найти учетные записи с настроенным делегированием</div>
                        <div class="command-code">Get-ADObject -Filter {msDS-AllowedToDelegateTo -ne "$null"} -Properties msDS-AllowedToDelegateTo, TrustedForDelegation | 
    Select-Object Name, 
                  ObjectClass,
                  TrustedForDelegation,
                  @{N='DelegationTargets';E={$_."msDS-AllowedToDelegateTo" -join '; '}} | 
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag advanced">Security</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Automation Section -->
        <div id="automation-section" class="content-section">
            <input type="text" class="search-box" placeholder="🔍 Поиск команд..." onkeyup="filterCommands('automation')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">🤖</span>
                    <span class="category-title">Автоматизация</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Автоматическое уведомление об истечении паролей</div>
                        <div class="command-description">Отправка email уведомлений пользователям</div>
                        <div class="command-code">$SMTPServer = "smtp.domain.com"
$FromEmail = "it-notifications@domain.com"
$DaysToWarn = 14
$MaxPasswordAge = (Get-ADDefaultDomainPasswordPolicy).MaxPasswordAge.Days

$Users = Get-ADUser -Filter {Enabled -eq $true -and PasswordNeverExpires -eq $false} -Properties PasswordLastSet, EmailAddress, DisplayName

foreach ($User in $Users) {
    if ($User.EmailAddress) {
        $PasswordExpiryDate = $User.PasswordLastSet.AddDays($MaxPasswordAge)
        $DaysUntilExpiry = ($PasswordExpiryDate - (Get-Date)).Days
        
        if ($DaysUntilExpiry -le $DaysToWarn -and $DaysUntilExpiry -ge 0) {
            $Subject = "Password Expiry Notice - $DaysUntilExpiry days remaining"
            $Body = @"
<html>
<body style='font-family: Arial, sans-serif;'>
    <h2>Password Expiration Notice</h2>
    <p>Dear $($User.DisplayName),</p>
    <p>Your password will expire on <strong>$PasswordExpiryDate</strong>.</p>
    <p>You have <strong style='color: red;'>$DaysUntilExpiry days</strong> remaining to change your password.</p>
    <p>Please change your password at your earliest convenience to avoid any disruption to your work.</p>
    <br>
    <p>Best regards,<br>IT Support Team</p>
</body>
</html>
"@
            
            Send-MailMessage -SmtpServer $SMTPServer -From $FromEmail -To $User.EmailAddress `
                           -Subject $Subject -Body $Body -BodyAsHtml
            
            Write-Host "Notification sent to $($User.DisplayName) - $DaysUntilExpiry days left" -ForegroundColor Green
        }
    }
}</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag important">Email</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Автоматическое создание домашних папок</div>
                        <div class="command-description">Создание и настройка прав для домашних директорий пользователей</div>
                        <div class="command-code">$HomePath = "\\fileserver\Home$"
$Users = Get-ADUser -Filter * -Properties HomeDirectory

foreach ($User in $Users) {
    $UserFolder = Join-Path $HomePath $User.SamAccountName
    
    if (-not (Test-Path $UserFolder)) {
        # Create folder
        New-Item -ItemType Directory -Path $UserFolder -Force
        
        # Set permissions
        $Acl = Get-Acl $UserFolder
        $Permission = "$($env:USERDOMAIN)\$($User.SamAccountName)","FullControl","ContainerInherit,ObjectInherit","None","Allow"
        $AccessRule = New-Object System.Security.AccessControl.FileSystemAccessRule $Permission
        $Acl.SetAccessRule($AccessRule)
        Set-Acl -Path $UserFolder -AclObject $Acl
        
        # Set home directory in AD
        Set-ADUser -Identity $User -HomeDirectory $UserFolder -HomeDrive "H:"
        
        Write-Host "Created home folder for $($User.SamAccountName)" -ForegroundColor Green
    }
}</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Troubleshoot Section -->
        <div id="troubleshoot-section" class="content-section">
            <input type="text" class="search-box" placeholder="🔍 Поиск команд..." onkeyup="filterCommands('troubleshoot')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">🔧</span>
                    <span class="category-title">Диагностика и устранение проблем</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Диагностика проблем входа пользователя</div>
                        <div class="command-description">Полная диагностика проблем аутентификации</div>
                        <div class="command-code">$Username = Read-Host "Enter username to diagnose"

$User = Get-ADUser -Identity $Username -Properties *

Write-Host "`n=== User Login Diagnostics for $Username ===" -ForegroundColor Cyan

# Account Status
Write-Host "`nAccount Status:" -ForegroundColor Yellow
Write-Host "  Enabled: $($User.Enabled)"
Write-Host "  Locked Out: $($User.LockedOut)"
Write-Host "  Account Expires: $(if($User.AccountExpirationDate){"$($User.AccountExpirationDate)"}else{"Never"})"

# Password Status
Write-Host "`nPassword Status:" -ForegroundColor Yellow
Write-Host "  Password Expired: $($User.PasswordExpired)"
Write-Host "  Password Never Expires: $($User.PasswordNeverExpires)"
Write-Host "  Password Last Set: $($User.PasswordLastSet)"
Write-Host "  Must Change Password: $($User.PasswordMustChange)"

# Logon Information
Write-Host "`nLogon Information:" -ForegroundColor Yellow
Write-Host "  Last Successful Logon: $($User.LastLogonDate)"
Write-Host "  Last Bad Password Attempt: $($User.LastBadPasswordAttempt)"
Write-Host "  Bad Password Count: $($User.BadLogonCount)"

# Logon Restrictions
Write-Host "`nLogon Restrictions:" -ForegroundColor Yellow
Write-Host "  Logon Workstations: $(if($User.LogonWorkstations){"$($User.LogonWorkstations)"}else{"All"})"
Write-Host "  Logon Hours: $(if($User.logonHours){"Restricted"}else{"All Hours"})"

# Group Membership
Write-Host "`nGroup Membership:" -ForegroundColor Yellow
$Groups = Get-ADPrincipalGroupMembership $Username | Select-Object -ExpandProperty Name
$Groups | ForEach-Object { Write-Host "  - $_" }

# Recommendations
Write-Host "`nRecommendations:" -ForegroundColor Green
if ($User.LockedOut) { Write-Host "  ⚠️ Account is locked - run: Unlock-ADAccount -Identity $Username" }
if ($User.PasswordExpired) { Write-Host "  ⚠️ Password expired - reset password" }
if (-not $User.Enabled) { Write-Host "  ⚠️ Account disabled - run: Enable-ADAccount -Identity $Username" }</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag important">Diagnostic</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Тест LDAP соединения</div>
                        <div class="command-description">Проверка подключения к контроллерам домена</div>
                        <div class="command-code">$DCs = Get-ADDomainController -Filter * | Select-Object -ExpandProperty HostName

foreach ($DC in $DCs) {
    Write-Host "`nTesting $DC..." -ForegroundColor Cyan
    
    # Test LDAP (389)
    $LDAP = Test-NetConnection -ComputerName $DC -Port 389 -WarningAction SilentlyContinue
    Write-Host "  LDAP (389): $(if($LDAP.TcpTestSucceeded){'✅ Success'}else{'❌ Failed'})"
    
    # Test LDAPS (636)
    $LDAPS = Test-NetConnection -ComputerName $DC -Port 636 -WarningAction SilentlyContinue
    Write-Host "  LDAPS (636): $(if($LDAPS.TcpTestSucceeded){'✅ Success'}else{'❌ Failed'})"
    
    # Test Global Catalog (3268)
    $GC = Test-NetConnection -ComputerName $DC -Port 3268 -WarningAction SilentlyContinue
    Write-Host "  Global Catalog (3268): $(if($GC.TcpTestSucceeded){'✅ Success'}else{'❌ Failed'})"
    
    # Test Kerberos (88)
    $Kerberos = Test-NetConnection -ComputerName $DC -Port 88 -WarningAction SilentlyContinue
    Write-Host "  Kerberos (88): $(if($Kerberos.TcpTestSucceeded){'✅ Success'}else{'❌ Failed'})"
}</div>
                        <div class="copy-indicator">Скопировано!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Проверка FSMO ролей</div>
                        <div class="command-description">Определить владельцев FSMO ролей</div>
                        <div class="command-code"># Forest-wide FSMO roles
$Forest = Get-ADForest
Write-Host "`n=== Forest FSMO Roles ===" -ForegroundColor Cyan
Write-Host "Schema Master: $($Forest.SchemaMaster)"
Write-Host "Domain Naming Master: $($Forest.DomainNamingMaster)"

# Domain-wide FSMO roles
$Domain = Get-ADDomain
Write-Host "`n=== Domain FSMO Roles ===" -ForegroundColor Cyan
Write-Host "PDC Emulator: $($Domain.PDCEmulator)"
Write-Host "RID Master: $($Domain.RIDMaster)"
Write-Host "Infrastructure Master: $($Domain.InfrastructureMaster)"

# Test connectivity to FSMO holders
Write-Host "`n=== Testing FSMO Holders Connectivity ===" -ForegroundColor Yellow
$FSMOHolders = @($Forest.SchemaMaster, $Forest.DomainNamingMaster, $Domain.PDCEmulator, $Domain.RIDMaster, $Domain.InfrastructureMaster) | Select-Object -Unique

foreach ($Server in $FSMOHolders) {
    $Online = Test-Connection -ComputerName $Server -Count 1 -Quiet
    Write-Host "$Server : $(if($Online){'✅ Online'}else{'❌ Offline'})"
}</div>
                        <div class="copy-indicator">Скопировано!</div>
                        <div class="command-tags">
                            <span class="tag important">Infrastructure</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="floating-menu">
        <button class="floating-btn" onclick="scrollToTop()" title="Наверх">⬆️</button>
    </div>

    <script>
        // Show section
        function showSection(sectionName) {
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(`${sectionName}-section`).classList.add('active');
            event.target.classList.add('active');
        }

        // Copy command
        function copyCommand(element) {
            const codeElement = element.querySelector('.command-code');
            const indicatorElement = element.querySelector('.copy-indicator');
            
            const textArea = document.createElement('textarea');
            textArea.value = codeElement.textContent;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            
            indicatorElement.classList.add('show');
            setTimeout(() => {
                indicatorElement.classList.remove('show');
            }, 2000);
        }

        // Filter commands
        function filterCommands(section) {
            const searchTerm = event.target.value.toLowerCase();
            const cards = document.querySelectorAll(`#${section}-section .command-card`);
            
            cards.forEach(card => {
                const text = card.textContent.toLowerCase();
                card.style.display = text.includes(searchTerm) ? 'block' : 'none';
            });
        }

        // Scroll to top
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html>