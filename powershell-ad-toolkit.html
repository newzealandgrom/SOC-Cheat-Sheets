<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PowerShell AD Commands - Ultimate Collection</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #1a1a1a;
            --bg-secondary: #242424;
            --bg-card: #2d2d2d;
            --bg-hover: #3a3a3a;
            --text-primary: #ffffff;
            --text-secondary: #b8b8b8;
            --accent: #ffd700;
            --accent-hover: #ffed4e;
            --success: #52c41a;
            --danger: #ff4d4f;
            --info: #1890ff;
            --border: #404040;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, #0f0f0f 100%);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: var(--bg-secondary);
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            text-align: center;
            border: 2px solid var(--accent);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .header h1 {
            color: var(--accent);
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }

        .header p {
            color: var(--text-secondary);
            font-size: 1.1em;
        }

        .stats-bar {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .stat-item {
            background: var(--bg-card);
            padding: 15px 30px;
            border-radius: 8px;
            border: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .stat-number {
            color: var(--accent);
            font-size: 1.8em;
            font-weight: bold;
        }

        .stat-label {
            color: var(--text-secondary);
        }

        .navigation {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            background: var(--bg-secondary);
            padding: 15px;
            border-radius: 10px;
            position: sticky;
            top: 10px;
            z-index: 100;
            box-shadow: 0 5px 20px rgba(0,0,0,0.5);
        }

        .nav-btn {
            flex: 1;
            min-width: 140px;
            padding: 12px 20px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            text-align: center;
        }

        .nav-btn:hover {
            background: var(--bg-hover);
            border-color: var(--accent);
            transform: translateY(-2px);
        }

        .nav-btn.active {
            background: var(--accent);
            color: var(--bg-primary);
            border-color: var(--accent);
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .search-box {
            width: 100%;
            padding: 15px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 16px;
            margin-bottom: 25px;
        }

        .search-box:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.1);
        }

        .command-category {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
            border: 1px solid var(--border);
        }

        .category-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--accent);
        }

        .category-icon {
            font-size: 1.5em;
        }

        .category-title {
            font-size: 1.4em;
            color: var(--accent);
            font-weight: bold;
        }

        .commands-grid {
            display: grid;
            gap: 15px;
        }

        .command-card {
            background: var(--bg-card);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .command-card:hover {
            background: var(--bg-hover);
            border-color: var(--accent);
            transform: translateX(5px);
        }

        .command-card::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 3px;
            background: var(--accent);
            transform: scaleY(0);
            transition: transform 0.3s;
        }

        .command-card:hover::before {
            transform: scaleY(1);
        }

        .command-name {
            color: var(--accent);
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 8px;
        }

        .command-description {
            color: var(--text-secondary);
            margin-bottom: 15px;
            font-size: 0.95em;
        }

        .command-code {
            background: #0a0a0a;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 13px;
            color: #00ff00;
            overflow-x: auto;
            border-left: 3px solid var(--accent);
            position: relative;
        }

        .command-code:hover {
            background: #0f0f0f;
        }

        .copy-indicator {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--success);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        .copy-indicator.show {
            opacity: 1;
        }

        .command-tags {
            display: flex;
            gap: 8px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .tag {
            padding: 4px 8px;
            background: var(--bg-hover);
            border-radius: 4px;
            font-size: 11px;
            color: var(--text-secondary);
            border: 1px solid var(--border);
        }

        .tag.important {
            background: rgba(255, 215, 0, 0.1);
            border-color: var(--accent);
            color: var(--accent);
        }

        .tag.new {
            background: rgba(82, 196, 26, 0.1);
            border-color: var(--success);
            color: var(--success);
        }

        .tag.advanced {
            background: rgba(24, 144, 255, 0.1);
            border-color: var(--info);
            color: var(--info);
        }

        .quick-filters {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .filter-btn:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        .filter-btn.active {
            background: var(--accent);
            color: var(--bg-primary);
            border-color: var(--accent);
        }

        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-primary);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--accent);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent-hover);
        }

        .floating-menu {
            position: fixed;
            right: 20px;
            bottom: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .floating-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--accent);
            color: var(--bg-primary);
            border: none;
            cursor: pointer;
            font-size: 20px;
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.3);
            transition: all 0.3s;
        }

        .floating-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 30px rgba(255, 215, 0, 0.5);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚ö° PowerShell AD Commands</h1>
            <p>–ü–æ–ª–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è –∫–æ–º–∞–Ω–¥ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Active Directory</p>
        </div>

        <div class="stats-bar">
            <div class="stat-item">
                <span class="stat-number">250+</span>
                <span class="stat-label">–ö–æ–º–∞–Ω–¥</span>
            </div>
            <div class="stat-item">
                <span class="stat-number">12</span>
                <span class="stat-label">–ö–∞—Ç–µ–≥–æ—Ä–∏–π</span>
            </div>
            <div class="stat-item">
                <span class="stat-number">50+</span>
                <span class="stat-label">–ê—Ç—Ä–∏–±—É—Ç–æ–≤</span>
            </div>
        </div>

        <div class="navigation">
            <button class="nav-btn active" onclick="showSection('users')">üë§ Users</button>
            <button class="nav-btn" onclick="showSection('groups')">üë• Groups</button>
            <button class="nav-btn" onclick="showSection('computers')">üíª Computers</button>
            <button class="nav-btn" onclick="showSection('passwords')">üîê Passwords</button>
            <button class="nav-btn" onclick="showSection('search')">üîç Search</button>
            <button class="nav-btn" onclick="showSection('export')">üìä Export</button>
            <button class="nav-btn" onclick="showSection('audit')">üìù Audit</button>
            <button class="nav-btn" onclick="showSection('maintenance')">üõ†Ô∏è Maintenance</button>
            <button class="nav-btn" onclick="showSection('reports')">üìà Reports</button>
            <button class="nav-btn" onclick="showSection('security')">üõ°Ô∏è Security</button>
            <button class="nav-btn" onclick="showSection('automation')">ü§ñ Automation</button>
            <button class="nav-btn" onclick="showSection('troubleshoot')">üîß Troubleshoot</button>
        </div>

        <!-- Users Section -->
        <div id="users-section" class="content-section active">
            <input type="text" class="search-box" placeholder="üîç –ü–æ–∏—Å–∫ –∫–æ–º–∞–Ω–¥..." onkeyup="filterCommands('users')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">üìã</span>
                    <span class="category-title">–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π</div>
                        <div class="command-description">–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ –≤—Å–µ–º–∏ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏</div>
                        <div class="command-code">Get-ADUser -Filter * -Properties *</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ (–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ)</div>
                        <div class="command-description">–ó–∞–ø—Ä–æ—Å –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤—ã–≤–æ–¥ –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤–∫–ª—é—á–∞—è –¥–∞—Ç—É –∏—Å—Ç–µ—á–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è</div>
                        <div class="command-code">$u = Read-Host 'User name'
$user = Get-ADUser -Identity $u -Properties LockedOut,DisplayName,PasswordLastSet,LastLogonDate,Description,info,EmailAddress,PasswordExpired,PasswordNeverExpires,LastBadPasswordAttempt,City,whenCreated,Enabled,EmailAddress,msDS-UserPasswordExpiryTimeComputed

if ($user.PasswordNeverExpires -eq $true) {
    $expiryDate = "–ü–∞—Ä–æ–ª—å –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å—Ç–µ–∫–∞–µ—Ç"
} else {
    $expiryDate = [datetime]::FromFileTime($user."msDS-UserPasswordExpiryTimeComputed")
}

$user | Select-Object DisplayName, LockedOut, PasswordLastSet, LastLogonDate, Description, info, EmailAddress, PasswordExpired, PasswordNeverExpires, LastBadPasswordAttempt, City, whenCreated, Enabled, @{Name="PasswordExpiryDate";Expression={$expiryDate}}</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag important">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π</span>
                            <span class="tag new">–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–µ–∑ email</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø—É—Å—Ç—ã–º –ø–æ–ª–µ–º email</div>
                        <div class="command-code">Get-ADUser -Filter * -Properties EmailAddress | Where-Object -Property EmailAddress -eq $null</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –∏–º–µ–Ω–∏ (—Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ)</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ —á–∞—Å—Ç–∏ –∏–º–µ–Ω–∏</div>
                        <div class="command-code">Get-ADUser -Filter "(Name -like '*Dmitry*') -and (Enabled -eq 'True')" -Properties * | Select-Object Name, Enabled, SamAccountName, EmailAddress, Department</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –æ—Ç–¥–µ–ª–∞</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –æ—Ç–¥–µ–ª–∞</div>
                        <div class="command-code">Get-ADUser -Filter {Department -eq "IT"} -Properties Department, Title, Office | Select-Object Name, Department, Title, Office</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ –≤—Å–µ—Ö –ø–æ–¥—á–∏–Ω–µ–Ω–Ω—ã—Ö –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞</div>
                        <div class="command-code">$manager = Get-ADUser -Identity "ManagerUsername"
Get-ADUser -Filter {Manager -eq $manager.DistinguishedName} -Properties Manager, Title | Select-Object Name, Title</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π OU</div>
                        <div class="command-description">–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π Organizational Unit</div>
                        <div class="command-code">Get-ADUser -Filter * -SearchBase "OU=Sales,OU=Users,DC=domain,DC=com" -Properties * | Select-Object Name, Title, Department</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –≤—Å–µ DC</div>
                        <div class="command-description">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –≤—Å–µ–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞–º –¥–æ–º–µ–Ω–∞</div>
                        <div class="command-code">$Username = "username"
$DCs = Get-ADDomainController -Filter * | Select-Object -ExpandProperty Name
$LastLogon = @{}

foreach ($DC in $DCs) {
    try {
        $User = Get-ADUser $Username -Server $DC -Properties lastLogon, lastLogonTimestamp
        $LastLogon[$DC] = [datetime]::FromFileTime([Math]::Max($User.lastLogon, $User.lastLogonTimestamp))
    }
    catch {
        $LastLogon[$DC] = "N/A"
    }
}

$LastLogon.GetEnumerator() | Sort-Object Value -Descending | Format-Table -AutoSize</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag advanced">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –∏—Å—Ç–µ–∫–∞—é—â–∏–º —Å—Ä–æ–∫–æ–º –¥–µ–π—Å—Ç–≤–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —á—å–∏ –∞–∫–∫–∞—É–Ω—Ç—ã –∏—Å—Ç–µ–∫–∞—é—Ç –≤ –±–ª–∏–∂–∞–π—à–∏–µ 30 –¥–Ω–µ–π</div>
                        <div class="command-code">$ExpiryDate = (Get-Date).AddDays(30)
Get-ADUser -Filter {AccountExpirationDate -lt $ExpiryDate -and AccountExpirationDate -ne $null} -Properties AccountExpirationDate | 
    Select-Object Name, SamAccountName, AccountExpirationDate | 
    Sort-Object AccountExpirationDate</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø—É—Å—Ç—ã–º–∏ –ø–æ–ª—è–º–∏</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –Ω–µ–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ –≤–∞–∂–Ω—ã–º–∏ –ø–æ–ª—è–º–∏</div>
                        <div class="command-code">Get-ADUser -Filter * -Properties EmailAddress, Department, Title, Manager, Office | 
    Where-Object {
        -not $_.EmailAddress -or 
        -not $_.Department -or 
        -not $_.Title -or 
        -not $_.Manager -or 
        -not $_.Office
    } | Select-Object Name, EmailAddress, Department, Title, Office</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>
                </div>
            </div>

            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">üîí</span>
                    <span class="category-title">–°—Ç–∞—Ç—É—Å –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ –≤—Å–µ—Ö –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                        <div class="command-code">Search-ADAccount -LockedOut | Select-Object Name, SamAccountName, LockedOut, LastLogonDate</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–û—Ç–∫–ª—é—á–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</div>
                        <div class="command-description">–°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã—Ö —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π</div>
                        <div class="command-code">Get-ADUser -Filter {Enabled -eq $false} -Properties LastLogonDate, whenChanged | 
    Select-Object Name, SamAccountName, Enabled, LastLogonDate, whenChanged | 
    Sort-Object whenChanged -Descending</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –∏—Å—Ç–µ–∫—à–∏–º–∏ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∏—Å—Ç–µ–∫—à–∏–º —Å—Ä–æ–∫–æ–º –¥–µ–π—Å—Ç–≤–∏—è —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏</div>
                        <div class="command-code">Search-ADAccount -AccountExpired | Select-Object Name, AccountExpirationDate, Enabled</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ò—Å—Ç–æ—Ä–∏—è –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞</div>
                        <div class="command-description">–ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–∫–∞—Ö –≤—Ö–æ–¥–∞</div>
                        <div class="command-code">Get-ADUser -Filter * -Properties BadLogonCount, LastBadPasswordAttempt, BadPwdCount, LockedOut | 
    Where-Object {$_.BadLogonCount -gt 0} | 
    Select-Object Name, BadLogonCount, LastBadPasswordAttempt, LockedOut | 
    Sort-Object BadLogonCount -Descending</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                        <div class="command-description">–ú–∞—Å—Å–æ–≤–∞—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤—Å–µ—Ö –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                        <div class="command-code">Search-ADAccount -LockedOut | Unlock-ADAccount</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag important">–û—Å—Ç–æ—Ä–æ–∂–Ω–æ</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">‚úèÔ∏è</span>
                    <span class="category-title">–°–æ–∑–¥–∞–Ω–∏–µ –∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∞—Ç—Ä–∏–±—É—Ç–æ–≤)</div>
                        <div class="command-description">–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ –≤—Å–µ–º–∏ –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏</div>
                        <div class="command-code">New-ADUser -Name "Ivan Petrov" `
    -GivenName "Ivan" `
    -Surname "Petrov" `
    -SamAccountName "ipetrov" `
    -UserPrincipalName "ipetrov@domain.com" `
    -EmailAddress "ipetrov@domain.com" `
    -Path "OU=Users,DC=domain,DC=com" `
    -AccountPassword (ConvertTo-SecureString "P@ssw0rd123!" -AsPlainText -Force) `
    -ChangePasswordAtLogon $true `
    -Department "IT" `
    -Title "System Administrator" `
    -Office "Moscow" `
    -OfficePhone "+7-495-123-4567" `
    -Company "Company Name" `
    -Manager "jsmith" `
    -Enabled $true</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</div>
                        <div class="command-description">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ</div>
                        <div class="command-code">$TemplateUser = Get-ADUser -Identity "TemplateUser" -Properties *
$NewUser = @{
    Name = "New User"
    GivenName = "New"
    Surname = "User"
    SamAccountName = "nuser"
    UserPrincipalName = "nuser@domain.com"
    AccountPassword = (ConvertTo-SecureString "TempP@ss123" -AsPlainText -Force)
    Path = $TemplateUser.DistinguishedName.Split(',',2)[1]
    Department = $TemplateUser.Department
    Title = $TemplateUser.Title
    Company = $TemplateUser.Company
    Manager = $TemplateUser.Manager
    Office = $TemplateUser.Office
    Enabled = $true
    ChangePasswordAtLogon = $true
}
New-ADUser @NewUser

# –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —á–ª–µ–Ω—Å—Ç–≤–æ –≤ –≥—Ä—É–ø–ø–∞—Ö
Get-ADPrincipalGroupMembership $TemplateUser | Where-Object {$_.Name -ne "Domain Users"} | Add-ADPrincipalGroupMembership -Members "nuser"</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag advanced">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ú–∞—Å—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤</div>
                        <div class="command-description">–û–±–Ω–æ–≤–∏—Ç—å –∞—Ç—Ä–∏–±—É—Ç—ã –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ OU</div>
                        <div class="command-code">Get-ADUser -Filter * -SearchBase "OU=Sales,DC=domain,DC=com" | 
    Set-ADUser -Company "New Company Name" -Office "New Office"</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</div>
                        <div class="command-description">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ AD</div>
                        <div class="command-code">$photo = [byte[]](Get-Content "C:\Photos\user.jpg" -Encoding byte)
Set-ADUser "username" -Replace @{thumbnailPhoto=$photo}</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Groups Section -->
        <div id="groups-section" class="content-section">
            <input type="text" class="search-box" placeholder="üîç –ü–æ–∏—Å–∫ –∫–æ–º–∞–Ω–¥..." onkeyup="filterCommands('groups')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">üë•</span>
                    <span class="category-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–∞–º–∏</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–í—Å–µ –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ)</div>
                        <div class="command-description">–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –≥—Ä—É–ø–ø—ã –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</div>
                        <div class="command-code">Get-ADUser "username" -Properties MemberOf | Select-Object -ExpandProperty MemberOf | Get-ADGroup | Select-Object Name, GroupCategory, GroupScope</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ü—É—Å—Ç—ã–µ –≥—Ä—É–ø–ø—ã</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ –≤—Å–µ –≥—Ä—É–ø–ø—ã –±–µ–∑ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</div>
                        <div class="command-code">Get-ADGroup -Filter * -Properties Members | Where-Object {$_.Members.Count -eq 0} | Select-Object Name, GroupCategory, DistinguishedName</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ì—Ä—É–ø–ø—ã —Å –æ–¥–Ω–∏–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–º</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ –≥—Ä—É–ø–ø—ã —Ç–æ–ª—å–∫–æ —Å –æ–¥–Ω–∏–º —á–ª–µ–Ω–æ–º</div>
                        <div class="command-code">Get-ADGroup -Filter * -Properties Members | Where-Object {$_.Members.Count -eq 1} | Select-Object Name, @{N='SingleMember';E={(Get-ADObject $_.Members[0]).Name}}</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ —á–ª–µ–Ω—Å—Ç–≤–æ –≤ –≥—Ä—É–ø–ø–µ</div>
                        <div class="command-description">–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö —á–ª–µ–Ω–æ–≤ –≥—Ä—É–ø–ø—ã –≤–∫–ª—é—á–∞—è –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –≥—Ä—É–ø–ø—ã</div>
                        <div class="command-code">Get-ADGroupMember -Identity "GroupName" -Recursive | Select-Object Name, ObjectClass, SamAccountName | Sort-Object ObjectClass, Name</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —á–ª–µ–Ω—Å—Ç–≤–∞ –¥–≤—É—Ö –≥—Ä—É–ø–ø</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ —Ä–∞–∑–ª–∏—á–∏—è –≤ —á–ª–µ–Ω—Å—Ç–≤–µ –º–µ–∂–¥—É –¥–≤—É–º—è –≥—Ä—É–ø–ø–∞–º–∏</div>
                        <div class="command-code">$Group1 = "Group1Name"
$Group2 = "Group2Name"

$Members1 = Get-ADGroupMember -Identity $Group1 | Select-Object -ExpandProperty SamAccountName
$Members2 = Get-ADGroupMember -Identity $Group2 | Select-Object -ExpandProperty SamAccountName

$Comparison = Compare-Object -ReferenceObject $Members1 -DifferenceObject $Members2 -IncludeEqual

$Comparison | ForEach-Object {
    [PSCustomObject]@{
        User = $_.InputObject
        Status = switch ($_.SideIndicator) {
            '<=' {"Only in $Group1"}
            '=>' {"Only in $Group2"}
            '==' {"In both groups"}
        }
    }
} | Format-Table -AutoSize</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag advanced">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ù–∞–π—Ç–∏ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –≤–ª–æ–∂–µ–Ω–∏—è –≥—Ä—É–ø–ø</div>
                        <div class="command-description">–û–±–Ω–∞—Ä—É–∂–∏—Ç—å —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –≥—Ä—É–ø–ø–∞—Ö</div>
                        <div class="command-code">function Find-CircularNesting {
    $Groups = Get-ADGroup -Filter *
    $CircularGroups = @()
    
    foreach ($Group in $Groups) {
        $AllMembers = @()
        try {
            $AllMembers = Get-ADGroupMember -Identity $Group -Recursive -ErrorAction Stop
            if ($Group.DistinguishedName -in $AllMembers.DistinguishedName) {
                $CircularGroups += $Group
            }
        } catch {
            if ($_.Exception.Message -like "*circular*") {
                $CircularGroups += $Group
            }
        }
    }
    return $CircularGroups
}

Find-CircularNesting | Select-Object Name, DistinguishedName</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag advanced">–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π</span>
                            <span class="tag important">–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –≥—Ä—É–ø–ø—ã –∏ –∏—Ö —á–ª–µ–Ω—ã</div>
                        <div class="command-description">–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –≥—Ä—É–ø–ø—ã —Å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏</div>
                        <div class="command-code">$AdminGroups = @("Domain Admins", "Enterprise Admins", "Schema Admins", "Administrators", "Account Operators", "Server Operators", "Backup Operators")

foreach ($Group in $AdminGroups) {
    Write-Host "`n=== $Group ===" -ForegroundColor Yellow
    try {
        Get-ADGroupMember -Identity $Group -Recursive | 
            Where-Object {$_.objectClass -eq 'user'} | 
            Get-ADUser -Properties Enabled, LastLogonDate | 
            Select-Object Name, SamAccountName, Enabled, LastLogonDate | 
            Format-Table -AutoSize
    } catch {
        Write-Host "Group not found or access denied" -ForegroundColor Red
    }
}</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag important">Security</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Computers Section -->
        <div id="computers-section" class="content-section">
            <input type="text" class="search-box" placeholder="üîç –ü–æ–∏—Å–∫ –∫–æ–º–∞–Ω–¥..." onkeyup="filterCommands('computers')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">üíª</span>
                    <span class="category-title">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞—Ö</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ Windows Servers</div>
                        <div class="command-description">–ü–æ–¥—Å—á–µ—Ç –≤—Å–µ—Ö Windows —Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ –¥–æ–º–µ–Ω–µ</div>
                        <div class="command-code">(Get-ADComputer -Filter {Enabled -eq "true" -and OperatingSystem -like "*Windows Server*"}).Count</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–î–µ—Ç–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ Windows Servers</div>
                        <div class="command-description">–ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö</div>
                        <div class="command-code">Get-ADComputer -Filter 'OperatingSystem -like "*Windows Server*" -and Enabled -eq "true"' -Properties Name, OperatingSystem, OperatingSystemVersion, OperatingSystemServicePack, IPv4Address, LastLogonDate | 
    Sort-Object -Property OperatingSystem | 
    Select-Object -Property Name, OperatingSystem, OperatingSystemVersion, OperatingSystemServicePack, IPv4Address, LastLogonDate | 
    Format-Table -Wrap -AutoSize</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ö–æ–º–ø—å—é—Ç–µ—Ä—ã –ø–æ –≤–µ—Ä—Å–∏—è–º –û–°</div>
                        <div class="command-description">–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤ –ø–æ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º —Å–∏—Å—Ç–µ–º–∞–º</div>
                        <div class="command-code">Get-ADComputer -Filter * -Properties OperatingSystem, OperatingSystemVersion | 
    Group-Object -Property OperatingSystem | 
    Select-Object @{Name="Operating System";Expression={$_.Name}}, 
                  @{Name="Count";Expression={$_.Count}}, 
                  @{Name="Versions";Expression={($_.Group | Select-Object -Unique OperatingSystemVersion).OperatingSystemVersion -join ', '}} | 
    Sort-Object Count -Descending | 
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ö–æ–º–ø—å—é—Ç–µ—Ä—ã –±–µ–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤—Ö–æ–¥–∞</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–ª–∏—Å—å –∫ –¥–æ–º–µ–Ω—É</div>
                        <div class="command-code">Get-ADComputer -Filter {LastLogonDate -notlike "*"} -Properties LastLogonDate, whenCreated | 
    Select-Object Name, DNSHostName, whenCreated | 
    Sort-Object whenCreated</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –¥–æ–º–µ–Ω–∞</div>
                        <div class="command-description">–°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ –¥–æ–º–µ–Ω–∞ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π</div>
                        <div class="command-code">Get-ADDomainController -Filter * | 
    Select-Object Name, IPv4Address, OperatingSystem, Site, IsGlobalCatalog, IsReadOnly, @{Name="FSMO Roles";Expression={$_.OperationMasterRoles -join ', '}} | 
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ö–æ–º–ø—å—é—Ç–µ—Ä—ã —Å BitLocker</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã —Å –≤–∫–ª—é—á–µ–Ω–Ω—ã–º BitLocker</div>
                        <div class="command-code">Get-ADObject -Filter {objectClass -eq "msFVE-RecoveryInformation"} -SearchBase (Get-ADRootDSE).defaultNamingContext -Properties msFVE-RecoveryPassword, whenCreated | 
    ForEach-Object {
        $ComputerName = ($_.DistinguishedName -split ',')[1] -replace 'CN=',''
        [PSCustomObject]@{
            Computer = $ComputerName
            RecoveryPasswordID = $_.Name
            WhenCreated = $_.whenCreated
        }
    } | Sort-Object Computer</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag advanced">Security</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤</div>
                        <div class="command-description">–ú–∞—Å—Å–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–Ω–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤</div>
                        <div class="command-code">Get-ADComputer -Filter {Enabled -eq $true} -Properties LastLogonDate | 
    Select-Object -First 20 | 
    ForEach-Object {
        $Computer = $_.Name
        $Online = Test-Connection -ComputerName $Computer -Count 1 -Quiet
        [PSCustomObject]@{
            Computer = $Computer
            Status = if($Online){"üü¢ Online"}else{"üî¥ Offline"}
            LastLogon = $_.LastLogonDate
        }
    } | Format-Table -AutoSize</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Passwords Section -->
        <div id="passwords-section" class="content-section">
            <input type="text" class="search-box" placeholder="üîç –ü–æ–∏—Å–∫ –∫–æ–º–∞–Ω–¥..." onkeyup="filterCommands('passwords')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">üîê</span>
                    <span class="category-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è–º–∏</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –±–µ—Å—Å—Ä–æ—á–Ω—ã–º–∏ –ø–∞—Ä–æ–ª—è–º–∏</div>
                        <div class="command-description">–≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–∞—Ä–æ–ª—è–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å—Ç–µ–∫–∞—é—Ç</div>
                        <div class="command-code">$users = Get-ADUser -Filter {(PasswordNeverExpires -eq $true) -and (Enabled -eq $true)} -Properties *
$users | Select-Object Name, SamAccountName, DistinguishedName, EmailAddress, Department, Title, PasswordLastSet, LastLogonDate | 
    Export-Csv -Path "C:\Export\NonExpiringPasswords_$(Get-Date -Format 'yyyyMMdd').csv" -NoTypeInformation</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag important">Security</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–°–µ—Ä–≤–∏—Å–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã –ø–æ –º–∞—Å–∫–µ</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ –≤—Å–µ —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä–æ–ª–µ–π</div>
                        <div class="command-code"># –ò–∑–º–µ–Ω–∏—Ç—å –º–∞—Å–∫—É –ø–æ–¥ —Å–≤–æ–∏ –Ω—É–∂–¥—ã (svc*, srv*, service*)
$mask = "*svc*"
$users = Get-ADUser -Filter "SamAccountName -like '$mask' -and Enabled -eq `$true" -Properties SamAccountName, PasswordNeverExpires, PasswordLastSet, ServicePrincipalName, Description

Write-Host "`n=== –°–µ—Ä–≤–∏—Å–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã —Å –º–∞—Å–∫–æ–π $mask ===" -ForegroundColor Yellow
foreach ($user in $users) {
    Write-Host "`n–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: $($user.SamAccountName)" -ForegroundColor Cyan
    Write-Host "  –û–ø–∏—Å–∞–Ω–∏–µ: $($user.Description)"
    Write-Host "  PasswordNeverExpires: $($user.PasswordNeverExpires)"
    Write-Host "  PasswordLastSet: $($user.PasswordLastSet)"
    Write-Host "  ServicePrincipalName: $($user.ServicePrincipalName -join ', ')"
}

Write-Host "`n–í—Å–µ–≥–æ –Ω–∞–π–¥–µ–Ω–æ: $($users.Count) –∞–∫–∫–∞—É–Ω—Ç–æ–≤" -ForegroundColor Green</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–¢–æ—á–Ω–∞—è –¥–∞—Ç–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</div>
                        <div class="command-description">–í—ã—á–∏—Å–ª–∏—Ç—å –¥–∞—Ç—É –∏—Å—Ç–µ—á–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</div>
                        <div class="command-code">Get-ADUser -Identity "USERNAME" -Properties msDS-UserPasswordExpiryTimeComputed, PasswordNeverExpires, PasswordLastSet | 
    Select-Object Name, 
                  PasswordLastSet,
                  PasswordNeverExpires,
                  @{Name="PasswordExpiryDate";Expression={
                      if($_.PasswordNeverExpires) {
                          "Never"
                      } else {
                          [datetime]::FromFileTime($_."msDS-UserPasswordExpiryTimeComputed")
                      }
                  }},
                  @{Name="DaysUntilExpiry";Expression={
                      if(-not $_.PasswordNeverExpires) {
                          (New-TimeSpan -Start (Get-Date) -End ([datetime]::FromFileTime($_."msDS-UserPasswordExpiryTimeComputed"))).Days
                      }
                  }}</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ü–∞—Ä–æ–ª–∏, –∏—Å—Ç–µ–∫–∞—é—â–∏–µ –≤ –±–ª–∏–∂–∞–π—à–∏–µ 14 –¥–Ω–µ–π</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∏—Å—Ç–µ–∫–∞—é—â–∏–º–∏ –ø–∞—Ä–æ–ª—è–º–∏</div>
                        <div class="command-code">$DaysToExpire = 14
$MaxPasswordAge = (Get-ADDefaultDomainPasswordPolicy).MaxPasswordAge.Days

Get-ADUser -Filter {Enabled -eq $true -and PasswordNeverExpires -eq $false} -Properties PasswordLastSet, EmailAddress, Manager | 
    Select-Object Name, 
                  SamAccountName, 
                  EmailAddress,
                  @{N='Manager';E={(Get-ADUser $_.Manager -ErrorAction SilentlyContinue).Name}},
                  PasswordLastSet,
                  @{N="ExpiryDate";E={$_.PasswordLastSet.AddDays($MaxPasswordAge)}},
                  @{N="DaysLeft";E={($_.PasswordLastSet.AddDays($MaxPasswordAge) - (Get-Date)).Days}} |
    Where-Object {$_.DaysLeft -le $DaysToExpire -and $_.DaysLeft -ge 0} |
    Sort-Object DaysLeft |
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ü–∞—Ä–æ–ª—å–Ω–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ –¥–æ–º–µ–Ω–∞</div>
                        <div class="command-description">–ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä–æ–ª—å–Ω–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏</div>
                        <div class="command-code">Get-ADDefaultDomainPasswordPolicy | 
    Select-Object @{N='–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞';E={$_.MinPasswordLength}},
                  @{N='–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç (–¥–Ω–µ–π)';E={$_.MaxPasswordAge.Days}},
                  @{N='–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç (–¥–Ω–µ–π)';E={$_.MinPasswordAge.Days}},
                  @{N='–ò—Å—Ç–æ—Ä–∏—è –ø–∞—Ä–æ–ª–µ–π';E={$_.PasswordHistoryCount}},
                  @{N='–°–ª–æ–∂–Ω–æ—Å—Ç—å –≤–∫–ª—é—á–µ–Ω–∞';E={$_.ComplexityEnabled}},
                  @{N='–ü–æ—Ä–æ–≥ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏';E={$_.LockoutThreshold}},
                  @{N='–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏';E={$_.LockoutDuration}},
                  @{N='–û–∫–Ω–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è';E={$_.LockoutObservationWindow}} |
    Format-List</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ú–∞—Å—Å–æ–≤—ã–π —Å–±—Ä–æ—Å –ø–∞—Ä–æ–ª–µ–π –∏–∑ CSV</div>
                        <div class="command-description">–°–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª–∏ –¥–ª—è —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ —Ñ–∞–π–ª–∞</div>
                        <div class="command-code"># CSV –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–ª–æ–Ω–∫—É SamAccountName
$Users = Import-Csv "C:\PasswordReset\users.csv"
$DefaultPassword = "TempP@ssw0rd2024!"
$Results = @()

foreach ($User in $Users) {
    try {
        Set-ADAccountPassword -Identity $User.SamAccountName `
            -Reset `
            -NewPassword (ConvertTo-SecureString $DefaultPassword -AsPlainText -Force)
        Set-ADUser -Identity $User.SamAccountName -ChangePasswordAtLogon $true
        
        $Results += [PSCustomObject]@{
            User = $User.SamAccountName
            Status = "Success"
            Message = "Password reset successfully"
        }
        Write-Host "‚úÖ Password reset for: $($User.SamAccountName)" -ForegroundColor Green
    }
    catch {
        $Results += [PSCustomObject]@{
            User = $User.SamAccountName
            Status = "Failed"
            Message = $_.Exception.Message
        }
        Write-Host "‚ùå Failed to reset password for: $($User.SamAccountName)" -ForegroundColor Red
    }
}

$Results | Export-Csv "C:\PasswordReset\results_$(Get-Date -Format 'yyyyMMdd_HHmmss').csv" -NoTypeInformation</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag important">Bulk Operation</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Fine-Grained Password Policies</div>
                        <div class="command-description">–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç–æ–Ω–∫–∏–µ –ø–∞—Ä–æ–ª—å–Ω—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏</div>
                        <div class="command-code">Get-ADFineGrainedPasswordPolicy -Filter * | 
    Select-Object Name, 
                  Precedence,
                  MinPasswordLength,
                  @{N='MaxPasswordAge';E={$_.MaxPasswordAge.Days}},
                  @{N='AppliesTo';E={($_.AppliesTo | ForEach-Object {(Get-ADObject $_).Name}) -join ', '}},
                  ComplexityEnabled,
                  LockoutThreshold | 
    Sort-Object Precedence | 
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag advanced">Advanced</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Search Section -->
        <div id="search-section" class="content-section">
            <input type="text" class="search-box" placeholder="üîç –ü–æ–∏—Å–∫ –∫–æ–º–∞–Ω–¥..." onkeyup="filterCommands('search')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">üîç</span>
                    <span class="category-title">–ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ –æ–±—ä–µ–∫—Ç–æ–≤</div>
                        <div class="command-description">–ü–æ–∏—Å–∫ –ª—é–±—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ AD –ø–æ –∏–º–µ–Ω–∏</div>
                        <div class="command-code">$SearchTerm = "*admin*"
Get-ADObject -Filter "Name -like '$SearchTerm'" | 
    Select-Object Name, ObjectClass, DistinguishedName | 
    Sort-Object ObjectClass, Name | 
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ü–æ–∏—Å–∫ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º –≤ –æ–ø–∏—Å–∞–Ω–∏–∏</div>
                        <div class="command-code">Get-ADObject -Filter {Description -like "*service account*"} -Properties Description | 
    Select-Object Name, ObjectClass, Description | 
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ü–æ–∏—Å–∫ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ email</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ email –∞–¥—Ä–µ—Å–∞–º–∏</div>
                        <div class="command-code">Get-ADUser -Filter {EmailAddress -like "*"} -Properties EmailAddress | 
    Group-Object -Property EmailAddress | 
    Where-Object {$_.Count -gt 1} | 
    ForEach-Object {
        Write-Host "`nDuplicate Email: $($_.Name)" -ForegroundColor Red
        $_.Group | Select-Object Name, SamAccountName, DistinguishedName | Format-Table -AutoSize
    }</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag important">Data Quality</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ü–æ–∏—Å–∫ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞</div>
                        <div class="command-code">$PhoneNumber = "*495*"
Get-ADUser -Filter "telephoneNumber -like '$PhoneNumber' -or mobile -like '$PhoneNumber' -or homePhone -like '$PhoneNumber'" -Properties telephoneNumber, mobile, homePhone | 
    Select-Object Name, 
                  @{N='Office';E={$_.telephoneNumber}}, 
                  @{N='Mobile';E={$_.mobile}}, 
                  @{N='Home';E={$_.homePhone}} | 
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ü–æ–∏—Å–∫ –ø–æ SID</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ –æ–±—ä–µ–∫—Ç –ø–æ Security Identifier</div>
                        <div class="command-code">$SID = "S-1-5-21-..."
Get-ADObject -Filter {objectSid -eq $SID} -Properties * | 
    Select-Object Name, ObjectClass, DistinguishedName</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Wildcard –ø–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                        <div class="command-description">–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º wildcards</div>
                        <div class="command-code"># –ü–æ–∏—Å–∫ –ø–æ –Ω–∞—á–∞–ª—É –∏–º–µ–Ω–∏
Get-ADUser -Filter {Name -like "John*"}

# –ü–æ–∏—Å–∫ –ø–æ –æ–∫–æ–Ω—á–∞–Ω–∏—é
Get-ADUser -Filter {Name -like "*son"}

# –ü–æ–∏—Å–∫ –ø–æ —Å–µ—Ä–µ–¥–∏–Ω–µ
Get-ADUser -Filter {Name -like "*mit*"}

# –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–∏—Å–∫
Get-ADUser -Filter {(Name -like "J*") -and (Surname -like "S*")}</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Export Section -->
        <div id="export-section" class="content-section">
            <input type="text" class="search-box" placeholder="üîç –ü–æ–∏—Å–∫ –∫–æ–º–∞–Ω–¥..." onkeyup="filterCommands('export')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">üìä</span>
                    <span class="category-title">–≠–∫—Å–ø–æ—Ä—Ç –∏ –∏–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ü–æ–ª–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º</div>
                        <div class="command-description">–≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —á–∏—Ç–∞–µ–º—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º –º–µ–Ω–µ–¥–∂–µ—Ä–∞</div>
                        <div class="command-code">Get-ADUser -Filter * -Properties * | 
    Select-Object Name, 
                  SamAccountName,
                  UserPrincipalName,
                  EmailAddress,
                  Title,
                  Department,
                  Office,
                  @{N='Manager';E={(Get-ADUser $_.Manager -ErrorAction SilentlyContinue).Name}},
                  @{N='Groups';E={(Get-ADPrincipalGroupMembership $_.SamAccountName | Select-Object -ExpandProperty Name) -join '; '}},
                  Enabled,
                  @{N='PasswordNeverExpires';E={$_.PasswordNeverExpires}},
                  LastLogonDate,
                  whenCreated | 
    Export-Csv -Path "C:\Export\AllUsers_$(Get-Date -Format 'yyyyMMdd_HHmmss').csv" -NoTypeInformation -Encoding UTF8</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–≠–∫—Å–ø–æ—Ä—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã OU</div>
                        <div class="command-description">–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É Organizational Units</div>
                        <div class="command-code">Get-ADOrganizationalUnit -Filter * -Properties * | 
    Select-Object @{N='Level';E={($_.DistinguishedName -split ',').Count - 2}},
                  Name,
                  @{N='Parent';E={($_.DistinguishedName -split ',',2)[1]}},
                  Description,
                  @{N='Protected';E={$_.ProtectedFromAccidentalDeletion}},
                  whenCreated,
                  @{N='Children';E={(Get-ADObject -Filter * -SearchBase $_.DistinguishedName -SearchScope OneLevel).Count}} |
    Sort-Object Level, Parent, Name |
    Export-Csv -Path "C:\Export\OU_Structure.csv" -NoTypeInformation</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ú–∞—Å—Å–æ–≤—ã–π –∏–º–ø–æ—Ä—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π</div>
                        <div class="command-description">–ò–º–ø–æ—Ä—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ CSV —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º</div>
                        <div class="command-code"># CSV columns: Name,GivenName,Surname,SamAccountName,EmailAddress,Department,Title,Manager,Password
$Users = Import-Csv -Path "C:\Import\NewUsers.csv"
$LogFile = "C:\Import\import_log_$(Get-Date -Format 'yyyyMMdd_HHmmss').txt"
$ErrorLog = "C:\Import\import_errors_$(Get-Date -Format 'yyyyMMdd_HHmmss').txt"

foreach ($User in $Users) {
    try {
        # Check if user already exists
        if (Get-ADUser -Filter "SamAccountName -eq '$($User.SamAccountName)'" -ErrorAction SilentlyContinue) {
            $Message = "User $($User.SamAccountName) already exists - skipping"
            Write-Warning $Message
            Add-Content -Path $ErrorLog -Value "$(Get-Date -Format 'yyyy-MM-dd HH:mm:ss'): $Message"
            continue
        }
        
        # Create user parameters
        $NewUserParams = @{
            Name = $User.Name
            GivenName = $User.GivenName
            Surname = $User.Surname
            SamAccountName = $User.SamAccountName
            UserPrincipalName = "$($User.SamAccountName)@$((Get-ADDomain).DNSRoot)"
            EmailAddress = $User.EmailAddress
            Department = $User.Department
            Title = $User.Title
            AccountPassword = (ConvertTo-SecureString $User.Password -AsPlainText -Force)
            Enabled = $true
            ChangePasswordAtLogon = $true
            Path = "OU=Users,$(Get-ADDomain).DistinguishedName"
        }
        
        # Create user
        New-ADUser @NewUserParams
        
        # Set manager if specified
        if ($User.Manager) {
            Set-ADUser -Identity $User.SamAccountName -Manager $User.Manager
        }
        
        $Message = "Successfully created user: $($User.SamAccountName)"
        Write-Host $Message -ForegroundColor Green
        Add-Content -Path $LogFile -Value "$(Get-Date -Format 'yyyy-MM-dd HH:mm:ss'): $Message"
        
    } catch {
        $ErrorMessage = "Failed to create user $($User.SamAccountName): $_"
        Write-Error $ErrorMessage
        Add-Content -Path $ErrorLog -Value "$(Get-Date -Format 'yyyy-MM-dd HH:mm:ss'): $ErrorMessage"
    }
}

Write-Host "`nImport completed. Check logs at:" -ForegroundColor Cyan
Write-Host "  Success log: $LogFile" -ForegroundColor Green
Write-Host "  Error log: $ErrorLog" -ForegroundColor Yellow</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag important">Bulk Operation</span>
                            <span class="tag advanced">With Validation</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">Backup –ø–æ–ª–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã AD</div>
                        <div class="command-description">–°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω—ã–π backup –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ AD</div>
                        <div class="command-code">$BackupPath = "C:\ADBackup\$(Get-Date -Format 'yyyyMMdd')"
New-Item -ItemType Directory -Path $BackupPath -Force | Out-Null

Write-Host "Starting AD Backup to $BackupPath" -ForegroundColor Cyan

# Users
Write-Host "Backing up Users..." -ForegroundColor Yellow
Get-ADUser -Filter * -Properties * | Export-Clixml -Path "$BackupPath\Users.xml"

# Groups
Write-Host "Backing up Groups..." -ForegroundColor Yellow
Get-ADGroup -Filter * -Properties * | Export-Clixml -Path "$BackupPath\Groups.xml"

# Group Memberships
Write-Host "Backing up Group Memberships..." -ForegroundColor Yellow
Get-ADGroup -Filter * | ForEach-Object {
    $group = $_
    Get-ADGroupMember -Identity $group -Recursive | Select-Object @{N='Group';E={$group.Name}}, Name, SamAccountName, ObjectClass
} | Export-Clixml -Path "$BackupPath\GroupMemberships.xml"

# Computers
Write-Host "Backing up Computers..." -ForegroundColor Yellow
Get-ADComputer -Filter * -Properties * | Export-Clixml -Path "$BackupPath\Computers.xml"

# OUs
Write-Host "Backing up OUs..." -ForegroundColor Yellow
Get-ADOrganizationalUnit -Filter * -Properties * | Export-Clixml -Path "$BackupPath\OUs.xml"

# GPO Links
Write-Host "Backing up GPO Links..." -ForegroundColor Yellow
Get-ADOrganizationalUnit -Filter * | Get-GPInheritance | Export-Clixml -Path "$BackupPath\GPOLinks.xml"

Write-Host "`nBackup completed successfully!" -ForegroundColor Green
Write-Host "Location: $BackupPath" -ForegroundColor Cyan</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag important">Backup</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Audit Section -->
        <div id="audit-section" class="content-section">
            <input type="text" class="search-box" placeholder="üîç –ü–æ–∏—Å–∫ –∫–æ–º–∞–Ω–¥..." onkeyup="filterCommands('audit')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">üìù</span>
                    <span class="category-title">–ê—É–¥–∏—Ç –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø</div>
                        <div class="command-description">–î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –≤—Å–µ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º –≥—Ä—É–ø–ø–∞–º</div>
                        <div class="command-code">$PrivGroups = @(
    "Domain Admins", "Enterprise Admins", "Schema Admins", 
    "Administrators", "Account Operators", "Server Operators", 
    "Print Operators", "Backup Operators", "Replicator",
    "Remote Desktop Users", "Network Configuration Operators"
)

$Report = @()

foreach ($GroupName in $PrivGroups) {
    try {
        $Group = Get-ADGroup -Identity $GroupName -Properties *
        $Members = Get-ADGroupMember -Identity $GroupName -Recursive
        
        foreach ($Member in $Members) {
            if ($Member.objectClass -eq 'user') {
                $User = Get-ADUser -Identity $Member -Properties Enabled, LastLogonDate, PasswordLastSet, PasswordNeverExpires
                
                $Report += [PSCustomObject]@{
                    Group = $GroupName
                    UserName = $User.Name
                    SamAccountName = $User.SamAccountName
                    Enabled = $User.Enabled
                    LastLogon = $User.LastLogonDate
                    PasswordLastSet = $User.PasswordLastSet
                    PasswordNeverExpires = $User.PasswordNeverExpires
                    MemberType = 'Direct/Nested'
                }
            }
        }
    } catch {
        Write-Warning "Could not process group: $GroupName"
    }
}

$Report | Export-Csv -Path "C:\Audit\PrivilegedGroups_$(Get-Date -Format 'yyyyMMdd').csv" -NoTypeInformation
$Report | Format-Table -AutoSize</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag important">Security</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ê—É–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã, –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –Ω–µ–¥–µ–ª—é</div>
                        <div class="command-code">$Days = 7
$StartDate = (Get-Date).AddDays(-$Days)

Write-Host "`n=== Changes in last $Days days ===" -ForegroundColor Yellow

# Modified Users
Write-Host "`nModified Users:" -ForegroundColor Cyan
Get-ADUser -Filter {whenChanged -ge $StartDate} -Properties whenChanged, whenCreated | 
    Select-Object Name, 
                  @{N='Action';E={if($_.whenCreated -ge $StartDate){'Created'}else{'Modified'}}},
                  whenChanged | 
    Sort-Object whenChanged -Descending | 
    Format-Table -AutoSize

# Modified Groups
Write-Host "`nModified Groups:" -ForegroundColor Cyan
Get-ADGroup -Filter {whenChanged -ge $StartDate} -Properties whenChanged, whenCreated | 
    Select-Object Name, 
                  @{N='Action';E={if($_.whenCreated -ge $StartDate){'Created'}else{'Modified'}}},
                  whenChanged | 
    Sort-Object whenChanged -Descending | 
    Format-Table -AutoSize

# Modified Computers
Write-Host "`nModified Computers:" -ForegroundColor Cyan
Get-ADComputer -Filter {whenChanged -ge $StartDate} -Properties whenChanged, whenCreated | 
    Select-Object Name, 
                  @{N='Action';E={if($_.whenCreated -ge $StartDate){'Created'}else{'Modified'}}},
                  whenChanged | 
    Sort-Object whenChanged -Descending | 
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ê—É–¥–∏—Ç –ø—Ä–∞–≤ AdminSDHolder</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ –æ–±—ä–µ–∫—Ç—ã —Å AdminCount=1</div>
                        <div class="command-code">Get-ADUser -Filter {adminCount -eq 1} -Properties adminCount, MemberOf | 
    Select-Object Name, 
                  SamAccountName, 
                  Enabled,
                  @{N='ProtectedGroups';E={
                      ($_.MemberOf | ForEach-Object {(Get-ADGroup $_).Name}) -join ', '
                  }} | 
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag advanced">Security</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Maintenance Section -->
        <div id="maintenance-section" class="content-section">
            <input type="text" class="search-box" placeholder="üîç –ü–æ–∏—Å–∫ –∫–æ–º–∞–Ω–¥..." onkeyup="filterCommands('maintenance')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">üõ†Ô∏è</span>
                    <span class="category-title">–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ –æ—á–∏—Å—Ç–∫–∞</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ –∏ –æ—Ç–∫–ª—é—á–∏—Ç—å –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã</div>
                        <div class="command-code">$InactiveDays = 90
$InactiveDate = (Get-Date).AddDays(-$InactiveDays)

# Find inactive users
$InactiveUsers = Get-ADUser -Filter {LastLogonDate -lt $InactiveDate -and Enabled -eq $true} -Properties LastLogonDate

Write-Host "Found $($InactiveUsers.Count) inactive users (no logon in $InactiveDays days)" -ForegroundColor Yellow

# Find inactive computers  
$InactiveComputers = Get-ADComputer -Filter {LastLogonDate -lt $InactiveDate -and Enabled -eq $true} -Properties LastLogonDate

Write-Host "Found $($InactiveComputers.Count) inactive computers (no logon in $InactiveDays days)" -ForegroundColor Yellow

# Optional: Disable them
# $InactiveUsers | Disable-ADAccount
# $InactiveComputers | Disable-ADAccount</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–û—á–∏—Å—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö –≥—Ä—É–ø–ø</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ –∏ —É–¥–∞–ª–∏—Ç—å –ø—É—Å—Ç—ã–µ –≥—Ä—É–ø–ø—ã</div>
                        <div class="command-code">$EmptyGroups = Get-ADGroup -Filter * -Properties Members | 
    Where-Object {$_.Members.Count -eq 0 -and $_.GroupCategory -eq 'Security'}

Write-Host "Found $($EmptyGroups.Count) empty security groups" -ForegroundColor Yellow
$EmptyGroups | Select-Object Name, GroupScope, DistinguishedName | Format-Table -AutoSize

# To delete (uncomment):
# $EmptyGroups | Remove-ADGroup -Confirm:$false</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ AD</div>
                        <div class="command-description">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞–º–∏ –¥–æ–º–µ–Ω–∞</div>
                        <div class="command-code"># Get replication status
Write-Host "Checking AD Replication Status..." -ForegroundColor Cyan

# Summary
repadmin /replsummary

# Detailed check
Get-ADReplicationPartnerMetadata -Target * -Partition * |
    Select-Object Server, 
                  Partner, 
                  Partition,
                  ConsecutiveReplicationFailures,
                  LastReplicationSuccess,
                  @{N='LastRepDuration';E={$_.LastReplicationResult}} |
    Format-Table -AutoSize

# Check for failures
$Failures = Get-ADReplicationFailure -Target * -Scope Forest
if ($Failures) {
    Write-Host "`nReplication Failures Detected:" -ForegroundColor Red
    $Failures | Format-Table -AutoSize
} else {
    Write-Host "`nNo replication failures detected" -ForegroundColor Green
}</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag important">Health Check</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Reports Section -->
        <div id="reports-section" class="content-section">
            <input type="text" class="search-box" placeholder="üîç –ü–æ–∏—Å–∫ –∫–æ–º–∞–Ω–¥..." onkeyup="filterCommands('reports')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">üìà</span>
                    <span class="category-title">–û—Ç—á–µ—Ç—ã –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –æ—Ç—á–µ—Ç –æ –¥–æ–º–µ–Ω–µ</div>
                        <div class="command-description">–ü–æ–ª–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –¥–æ–º–µ–Ω—É Active Directory</div>
                        <div class="command-code">$Domain = Get-ADDomain
$Forest = Get-ADForest

Write-Host "`n========== DOMAIN REPORT ==========" -ForegroundColor Cyan
Write-Host "Domain: $($Domain.DNSRoot)"
Write-Host "NetBIOS: $($Domain.NetBIOSName)"
Write-Host "Forest: $($Forest.Name)"
Write-Host "Domain Functional Level: $($Domain.DomainMode)"
Write-Host "Forest Functional Level: $($Forest.ForestMode)"

# Statistics
$Stats = @{
    'Total Users' = (Get-ADUser -Filter *).Count
    'Enabled Users' = (Get-ADUser -Filter {Enabled -eq $true}).Count
    'Disabled Users' = (Get-ADUser -Filter {Enabled -eq $false}).Count
    'Locked Users' = (Search-ADAccount -LockedOut).Count
    'Total Groups' = (Get-ADGroup -Filter *).Count
    'Security Groups' = (Get-ADGroup -Filter {GroupCategory -eq "Security"}).Count
    'Distribution Groups' = (Get-ADGroup -Filter {GroupCategory -eq "Distribution"}).Count
    'Total Computers' = (Get-ADComputer -Filter *).Count
    'Enabled Computers' = (Get-ADComputer -Filter {Enabled -eq $true}).Count
    'Windows Servers' = (Get-ADComputer -Filter {OperatingSystem -like "*Server*"}).Count
    'Windows 10' = (Get-ADComputer -Filter {OperatingSystem -like "*Windows 10*"}).Count
    'Windows 11' = (Get-ADComputer -Filter {OperatingSystem -like "*Windows 11*"}).Count
    'Domain Controllers' = (Get-ADDomainController -Filter *).Count
    'Organizational Units' = (Get-ADOrganizationalUnit -Filter *).Count
}

Write-Host "`n=== Statistics ===" -ForegroundColor Yellow
$Stats.GetEnumerator() | Sort-Object Name | ForEach-Object {
    Write-Host "$($_.Key): $($_.Value)"
}</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">HTML –æ—Ç—á–µ—Ç –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö</div>
                        <div class="command-description">–°–æ–∑–¥–∞—Ç—å –∫—Ä–∞—Å–∏–≤—ã–π HTML –æ—Ç—á–µ—Ç</div>
                        <div class="command-code">$Users = Get-ADUser -Filter * -Properties * | 
    Select-Object Name, SamAccountName, EmailAddress, Department, Title, 
                  Enabled, LastLogonDate, PasswordLastSet, PasswordNeverExpires

$HTML = @"
<!DOCTYPE html>
<html>
<head>
    <title>AD Users Report</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f0f0f0; }
        h1 { color: #333; text-align: center; }
        table { border-collapse: collapse; width: 100%; margin: 20px auto; background: white; }
        th { background-color: #4CAF50; color: white; padding: 12px; text-align: left; }
        td { padding: 10px; border-bottom: 1px solid #ddd; }
        tr:hover { background-color: #f5f5f5; }
        .disabled { color: red; }
        .enabled { color: green; }
    </style>
</head>
<body>
    <h1>Active Directory Users Report - $(Get-Date -Format 'yyyy-MM-dd')</h1>
    <table>
        <tr>
            <th>Name</th>
            <th>Username</th>
            <th>Email</th>
            <th>Department</th>
            <th>Title</th>
            <th>Status</th>
            <th>Last Logon</th>
            <th>Password Set</th>
        </tr>
"@

foreach ($User in $Users) {
    $StatusClass = if ($User.Enabled) { "enabled" } else { "disabled" }
    $Status = if ($User.Enabled) { "Active" } else { "Disabled" }
    
    $HTML += @"
        <tr>
            <td>$($User.Name)</td>
            <td>$($User.SamAccountName)</td>
            <td>$($User.EmailAddress)</td>
            <td>$($User.Department)</td>
            <td>$($User.Title)</td>
            <td class='$StatusClass'>$Status</td>
            <td>$($User.LastLogonDate)</td>
            <td>$($User.PasswordLastSet)</td>
        </tr>
"@
}

$HTML += @"
    </table>
    <p style='text-align: center; color: #666;'>Total users: $($Users.Count)</p>
</body>
</html>
"@

$HTML | Out-File "C:\Reports\ADUsers_$(Get-Date -Format 'yyyyMMdd').html"
Write-Host "Report saved to C:\Reports\ADUsers_$(Get-Date -Format 'yyyyMMdd').html" -ForegroundColor Green</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag new">HTML Report</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Security Section -->
        <div id="security-section" class="content-section">
            <input type="text" class="search-box" placeholder="üîç –ü–æ–∏—Å–∫ –∫–æ–º–∞–Ω–¥..." onkeyup="filterCommands('security')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">üõ°Ô∏è</span>
                    <span class="category-title">–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ Kerberoastable –∞–∫–∫–∞—É–Ω—Ç–æ–≤</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ —É—á–µ—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏, —É—è–∑–≤–∏–º—ã–µ –¥–ª—è Kerberoasting</div>
                        <div class="command-code">Get-ADUser -Filter {ServicePrincipalName -ne "$null"} -Properties ServicePrincipalName, PasswordLastSet, LastLogonDate | 
    Select-Object Name, 
                  SamAccountName,
                  @{N='SPNs';E={$_.ServicePrincipalName -join '; '}},
                  PasswordLastSet,
                  LastLogonDate,
                  Enabled | 
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag important">Security</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ ASREPRoastable –∞–∫–∫–∞—É–Ω—Ç–æ–≤</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ —É—á–µ—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –±–µ–∑ Kerberos –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏</div>
                        <div class="command-code">Get-ADUser -Filter * -Properties DoesNotRequirePreAuth | 
    Where-Object {$_.DoesNotRequirePreAuth -eq $true} | 
    Select-Object Name, SamAccountName, DoesNotRequirePreAuth, Enabled | 
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag important">Security</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ Kerberos</div>
                        <div class="command-description">–ù–∞–π—Ç–∏ —É—á–µ—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏ —Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º</div>
                        <div class="command-code">Get-ADObject -Filter {msDS-AllowedToDelegateTo -ne "$null"} -Properties msDS-AllowedToDelegateTo, TrustedForDelegation | 
    Select-Object Name, 
                  ObjectClass,
                  TrustedForDelegation,
                  @{N='DelegationTargets';E={$_."msDS-AllowedToDelegateTo" -join '; '}} | 
    Format-Table -AutoSize</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag advanced">Security</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Automation Section -->
        <div id="automation-section" class="content-section">
            <input type="text" class="search-box" placeholder="üîç –ü–æ–∏—Å–∫ –∫–æ–º–∞–Ω–¥..." onkeyup="filterCommands('automation')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">ü§ñ</span>
                    <span class="category-title">–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –∏—Å—Ç–µ—á–µ–Ω–∏–∏ –ø–∞—Ä–æ–ª–µ–π</div>
                        <div class="command-description">–û—Ç–ø—Ä–∞–≤–∫–∞ email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º</div>
                        <div class="command-code">$SMTPServer = "smtp.domain.com"
$FromEmail = "it-notifications@domain.com"
$DaysToWarn = 14
$MaxPasswordAge = (Get-ADDefaultDomainPasswordPolicy).MaxPasswordAge.Days

$Users = Get-ADUser -Filter {Enabled -eq $true -and PasswordNeverExpires -eq $false} -Properties PasswordLastSet, EmailAddress, DisplayName

foreach ($User in $Users) {
    if ($User.EmailAddress) {
        $PasswordExpiryDate = $User.PasswordLastSet.AddDays($MaxPasswordAge)
        $DaysUntilExpiry = ($PasswordExpiryDate - (Get-Date)).Days
        
        if ($DaysUntilExpiry -le $DaysToWarn -and $DaysUntilExpiry -ge 0) {
            $Subject = "Password Expiry Notice - $DaysUntilExpiry days remaining"
            $Body = @"
<html>
<body style='font-family: Arial, sans-serif;'>
    <h2>Password Expiration Notice</h2>
    <p>Dear $($User.DisplayName),</p>
    <p>Your password will expire on <strong>$PasswordExpiryDate</strong>.</p>
    <p>You have <strong style='color: red;'>$DaysUntilExpiry days</strong> remaining to change your password.</p>
    <p>Please change your password at your earliest convenience to avoid any disruption to your work.</p>
    <br>
    <p>Best regards,<br>IT Support Team</p>
</body>
</html>
"@
            
            Send-MailMessage -SmtpServer $SMTPServer -From $FromEmail -To $User.EmailAddress `
                           -Subject $Subject -Body $Body -BodyAsHtml
            
            Write-Host "Notification sent to $($User.DisplayName) - $DaysUntilExpiry days left" -ForegroundColor Green
        }
    }
}</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag important">Email</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –¥–æ–º–∞—à–Ω–∏—Ö –ø–∞–ø–æ–∫</div>
                        <div class="command-description">–°–æ–∑–¥–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –¥–ª—è –¥–æ–º–∞—à–Ω–∏—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                        <div class="command-code">$HomePath = "\\fileserver\Home$"
$Users = Get-ADUser -Filter * -Properties HomeDirectory

foreach ($User in $Users) {
    $UserFolder = Join-Path $HomePath $User.SamAccountName
    
    if (-not (Test-Path $UserFolder)) {
        # Create folder
        New-Item -ItemType Directory -Path $UserFolder -Force
        
        # Set permissions
        $Acl = Get-Acl $UserFolder
        $Permission = "$($env:USERDOMAIN)\$($User.SamAccountName)","FullControl","ContainerInherit,ObjectInherit","None","Allow"
        $AccessRule = New-Object System.Security.AccessControl.FileSystemAccessRule $Permission
        $Acl.SetAccessRule($AccessRule)
        Set-Acl -Path $UserFolder -AclObject $Acl
        
        # Set home directory in AD
        Set-ADUser -Identity $User -HomeDirectory $UserFolder -HomeDrive "H:"
        
        Write-Host "Created home folder for $($User.SamAccountName)" -ForegroundColor Green
    }
}</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Troubleshoot Section -->
        <div id="troubleshoot-section" class="content-section">
            <input type="text" class="search-box" placeholder="üîç –ü–æ–∏—Å–∫ –∫–æ–º–∞–Ω–¥..." onkeyup="filterCommands('troubleshoot')">
            
            <div class="command-category">
                <div class="category-header">
                    <span class="category-icon">üîß</span>
                    <span class="category-title">–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º</span>
                </div>
                <div class="commands-grid">
                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º –≤—Ö–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</div>
                        <div class="command-description">–ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏</div>
                        <div class="command-code">$Username = Read-Host "Enter username to diagnose"

$User = Get-ADUser -Identity $Username -Properties *

Write-Host "`n=== User Login Diagnostics for $Username ===" -ForegroundColor Cyan

# Account Status
Write-Host "`nAccount Status:" -ForegroundColor Yellow
Write-Host "  Enabled: $($User.Enabled)"
Write-Host "  Locked Out: $($User.LockedOut)"
Write-Host "  Account Expires: $(if($User.AccountExpirationDate){"$($User.AccountExpirationDate)"}else{"Never"})"

# Password Status
Write-Host "`nPassword Status:" -ForegroundColor Yellow
Write-Host "  Password Expired: $($User.PasswordExpired)"
Write-Host "  Password Never Expires: $($User.PasswordNeverExpires)"
Write-Host "  Password Last Set: $($User.PasswordLastSet)"
Write-Host "  Must Change Password: $($User.PasswordMustChange)"

# Logon Information
Write-Host "`nLogon Information:" -ForegroundColor Yellow
Write-Host "  Last Successful Logon: $($User.LastLogonDate)"
Write-Host "  Last Bad Password Attempt: $($User.LastBadPasswordAttempt)"
Write-Host "  Bad Password Count: $($User.BadLogonCount)"

# Logon Restrictions
Write-Host "`nLogon Restrictions:" -ForegroundColor Yellow
Write-Host "  Logon Workstations: $(if($User.LogonWorkstations){"$($User.LogonWorkstations)"}else{"All"})"
Write-Host "  Logon Hours: $(if($User.logonHours){"Restricted"}else{"All Hours"})"

# Group Membership
Write-Host "`nGroup Membership:" -ForegroundColor Yellow
$Groups = Get-ADPrincipalGroupMembership $Username | Select-Object -ExpandProperty Name
$Groups | ForEach-Object { Write-Host "  - $_" }

# Recommendations
Write-Host "`nRecommendations:" -ForegroundColor Green
if ($User.LockedOut) { Write-Host "  ‚ö†Ô∏è Account is locked - run: Unlock-ADAccount -Identity $Username" }
if ($User.PasswordExpired) { Write-Host "  ‚ö†Ô∏è Password expired - reset password" }
if (-not $User.Enabled) { Write-Host "  ‚ö†Ô∏è Account disabled - run: Enable-ADAccount -Identity $Username" }</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag important">Diagnostic</span>
                        </div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–¢–µ—Å—Ç LDAP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è</div>
                        <div class="command-description">–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞–º –¥–æ–º–µ–Ω–∞</div>
                        <div class="command-code">$DCs = Get-ADDomainController -Filter * | Select-Object -ExpandProperty HostName

foreach ($DC in $DCs) {
    Write-Host "`nTesting $DC..." -ForegroundColor Cyan
    
    # Test LDAP (389)
    $LDAP = Test-NetConnection -ComputerName $DC -Port 389 -WarningAction SilentlyContinue
    Write-Host "  LDAP (389): $(if($LDAP.TcpTestSucceeded){'‚úÖ Success'}else{'‚ùå Failed'})"
    
    # Test LDAPS (636)
    $LDAPS = Test-NetConnection -ComputerName $DC -Port 636 -WarningAction SilentlyContinue
    Write-Host "  LDAPS (636): $(if($LDAPS.TcpTestSucceeded){'‚úÖ Success'}else{'‚ùå Failed'})"
    
    # Test Global Catalog (3268)
    $GC = Test-NetConnection -ComputerName $DC -Port 3268 -WarningAction SilentlyContinue
    Write-Host "  Global Catalog (3268): $(if($GC.TcpTestSucceeded){'‚úÖ Success'}else{'‚ùå Failed'})"
    
    # Test Kerberos (88)
    $Kerberos = Test-NetConnection -ComputerName $DC -Port 88 -WarningAction SilentlyContinue
    Write-Host "  Kerberos (88): $(if($Kerberos.TcpTestSucceeded){'‚úÖ Success'}else{'‚ùå Failed'})"
}</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                    </div>

                    <div class="command-card" onclick="copyCommand(this)">
                        <div class="command-name">–ü—Ä–æ–≤–µ—Ä–∫–∞ FSMO —Ä–æ–ª–µ–π</div>
                        <div class="command-description">–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ FSMO —Ä–æ–ª–µ–π</div>
                        <div class="command-code"># Forest-wide FSMO roles
$Forest = Get-ADForest
Write-Host "`n=== Forest FSMO Roles ===" -ForegroundColor Cyan
Write-Host "Schema Master: $($Forest.SchemaMaster)"
Write-Host "Domain Naming Master: $($Forest.DomainNamingMaster)"

# Domain-wide FSMO roles
$Domain = Get-ADDomain
Write-Host "`n=== Domain FSMO Roles ===" -ForegroundColor Cyan
Write-Host "PDC Emulator: $($Domain.PDCEmulator)"
Write-Host "RID Master: $($Domain.RIDMaster)"
Write-Host "Infrastructure Master: $($Domain.InfrastructureMaster)"

# Test connectivity to FSMO holders
Write-Host "`n=== Testing FSMO Holders Connectivity ===" -ForegroundColor Yellow
$FSMOHolders = @($Forest.SchemaMaster, $Forest.DomainNamingMaster, $Domain.PDCEmulator, $Domain.RIDMaster, $Domain.InfrastructureMaster) | Select-Object -Unique

foreach ($Server in $FSMOHolders) {
    $Online = Test-Connection -ComputerName $Server -Count 1 -Quiet
    Write-Host "$Server : $(if($Online){'‚úÖ Online'}else{'‚ùå Offline'})"
}</div>
                        <div class="copy-indicator">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>
                        <div class="command-tags">
                            <span class="tag important">Infrastructure</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="floating-menu">
        <button class="floating-btn" onclick="scrollToTop()" title="–ù–∞–≤–µ—Ä—Ö">‚¨ÜÔ∏è</button>
    </div>

    <script>
        // Show section
        function showSection(sectionName) {
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(`${sectionName}-section`).classList.add('active');
            event.target.classList.add('active');
        }

        // Copy command
        function copyCommand(element) {
            const codeElement = element.querySelector('.command-code');
            const indicatorElement = element.querySelector('.copy-indicator');
            
            const textArea = document.createElement('textarea');
            textArea.value = codeElement.textContent;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            
            indicatorElement.classList.add('show');
            setTimeout(() => {
                indicatorElement.classList.remove('show');
            }, 2000);
        }

        // Filter commands
        function filterCommands(section) {
            const searchTerm = event.target.value.toLowerCase();
            const cards = document.querySelectorAll(`#${section}-section .command-card`);
            
            cards.forEach(card => {
                const text = card.textContent.toLowerCase();
                card.style.display = text.includes(searchTerm) ? 'block' : 'none';
            });
        }

        // Scroll to top
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html>